
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="..">
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.3">
    
    
      
        <title>Utils - Sqooler</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.50c56a3b.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#utils" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Sqooler" class="md-header__button md-logo" aria-label="Sqooler" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Sqooler
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Utils
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/alqor-ug/sqooler" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Sqooler" class="md-nav__button md-logo" aria-label="Sqooler" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Sqooler
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/alqor-ug/sqooler" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Utils
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Utils
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#storage-providers" class="md-nav__link">
    <span class="md-ellipsis">
      Storage Providers
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.sqooler.storage_providers" class="md-nav__link">
    <span class="md-ellipsis">
      storage_providers
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.sqooler.storage_providers.DropboxProvider" class="md-nav__link">
    <span class="md-ellipsis">
      DropboxProvider
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DropboxProvider">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.sqooler.storage_providers.DropboxProvider.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.sqooler.storage_providers.DropboxProvider.delete_file" class="md-nav__link">
    <span class="md-ellipsis">
      delete_file()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.sqooler.storage_providers.DropboxProvider.get_file_content" class="md-nav__link">
    <span class="md-ellipsis">
      get_file_content()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.sqooler.storage_providers.DropboxProvider.get_file_queue" class="md-nav__link">
    <span class="md-ellipsis">
      get_file_queue()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.sqooler.storage_providers.DropboxProvider.get_job_content" class="md-nav__link">
    <span class="md-ellipsis">
      get_job_content()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.sqooler.storage_providers.DropboxProvider.get_next_job_in_queue" class="md-nav__link">
    <span class="md-ellipsis">
      get_next_job_in_queue()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.sqooler.storage_providers.DropboxProvider.move_file" class="md-nav__link">
    <span class="md-ellipsis">
      move_file()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.sqooler.storage_providers.DropboxProvider.update_file" class="md-nav__link">
    <span class="md-ellipsis">
      update_file()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.sqooler.storage_providers.DropboxProvider.update_in_database" class="md-nav__link">
    <span class="md-ellipsis">
      update_in_database()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.sqooler.storage_providers.DropboxProvider.upload" class="md-nav__link">
    <span class="md-ellipsis">
      upload()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.sqooler.storage_providers.DropboxProvider.upload_config" class="md-nav__link">
    <span class="md-ellipsis">
      upload_config()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.sqooler.storage_providers.LocalProvider" class="md-nav__link">
    <span class="md-ellipsis">
      LocalProvider
    </span>
  </a>
  
    <nav class="md-nav" aria-label="LocalProvider">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.sqooler.storage_providers.LocalProvider.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.sqooler.storage_providers.LocalProvider.delete_file" class="md-nav__link">
    <span class="md-ellipsis">
      delete_file()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.sqooler.storage_providers.LocalProvider.get_file_content" class="md-nav__link">
    <span class="md-ellipsis">
      get_file_content()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.sqooler.storage_providers.LocalProvider.get_file_queue" class="md-nav__link">
    <span class="md-ellipsis">
      get_file_queue()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.sqooler.storage_providers.LocalProvider.get_job_content" class="md-nav__link">
    <span class="md-ellipsis">
      get_job_content()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.sqooler.storage_providers.LocalProvider.get_next_job_in_queue" class="md-nav__link">
    <span class="md-ellipsis">
      get_next_job_in_queue()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.sqooler.storage_providers.LocalProvider.move_file" class="md-nav__link">
    <span class="md-ellipsis">
      move_file()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.sqooler.storage_providers.LocalProvider.update_file" class="md-nav__link">
    <span class="md-ellipsis">
      update_file()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.sqooler.storage_providers.LocalProvider.update_in_database" class="md-nav__link">
    <span class="md-ellipsis">
      update_in_database()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.sqooler.storage_providers.LocalProvider.upload" class="md-nav__link">
    <span class="md-ellipsis">
      upload()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.sqooler.storage_providers.LocalProvider.upload_config" class="md-nav__link">
    <span class="md-ellipsis">
      upload_config()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.sqooler.storage_providers.MongodbProvider" class="md-nav__link">
    <span class="md-ellipsis">
      MongodbProvider
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MongodbProvider">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.sqooler.storage_providers.MongodbProvider.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.sqooler.storage_providers.MongodbProvider.delete_file" class="md-nav__link">
    <span class="md-ellipsis">
      delete_file()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.sqooler.storage_providers.MongodbProvider.get_file_content" class="md-nav__link">
    <span class="md-ellipsis">
      get_file_content()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.sqooler.storage_providers.MongodbProvider.get_file_queue" class="md-nav__link">
    <span class="md-ellipsis">
      get_file_queue()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.sqooler.storage_providers.MongodbProvider.get_job_content" class="md-nav__link">
    <span class="md-ellipsis">
      get_job_content()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.sqooler.storage_providers.MongodbProvider.get_next_job_in_queue" class="md-nav__link">
    <span class="md-ellipsis">
      get_next_job_in_queue()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.sqooler.storage_providers.MongodbProvider.move_file" class="md-nav__link">
    <span class="md-ellipsis">
      move_file()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.sqooler.storage_providers.MongodbProvider.update_file" class="md-nav__link">
    <span class="md-ellipsis">
      update_file()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.sqooler.storage_providers.MongodbProvider.update_in_database" class="md-nav__link">
    <span class="md-ellipsis">
      update_in_database()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.sqooler.storage_providers.MongodbProvider.upload" class="md-nav__link">
    <span class="md-ellipsis">
      upload()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.sqooler.storage_providers.MongodbProvider.upload_config" class="md-nav__link">
    <span class="md-ellipsis">
      upload_config()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.sqooler.storage_providers.StorageProvider" class="md-nav__link">
    <span class="md-ellipsis">
      StorageProvider
    </span>
  </a>
  
    <nav class="md-nav" aria-label="StorageProvider">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.sqooler.storage_providers.StorageProvider.delete_file" class="md-nav__link">
    <span class="md-ellipsis">
      delete_file()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.sqooler.storage_providers.StorageProvider.get_file_content" class="md-nav__link">
    <span class="md-ellipsis">
      get_file_content()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.sqooler.storage_providers.StorageProvider.get_file_queue" class="md-nav__link">
    <span class="md-ellipsis">
      get_file_queue()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.sqooler.storage_providers.StorageProvider.get_job_content" class="md-nav__link">
    <span class="md-ellipsis">
      get_job_content()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.sqooler.storage_providers.StorageProvider.get_next_job_in_queue" class="md-nav__link">
    <span class="md-ellipsis">
      get_next_job_in_queue()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.sqooler.storage_providers.StorageProvider.move_file" class="md-nav__link">
    <span class="md-ellipsis">
      move_file()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.sqooler.storage_providers.StorageProvider.update_file" class="md-nav__link">
    <span class="md-ellipsis">
      update_file()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.sqooler.storage_providers.StorageProvider.update_in_database" class="md-nav__link">
    <span class="md-ellipsis">
      update_in_database()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.sqooler.storage_providers.StorageProvider.upload" class="md-nav__link">
    <span class="md-ellipsis">
      upload()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.sqooler.storage_providers.StorageProvider.upload_config" class="md-nav__link">
    <span class="md-ellipsis">
      upload_config()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#schemes" class="md-nav__link">
    <span class="md-ellipsis">
      Schemes
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.sqooler.schemes" class="md-nav__link">
    <span class="md-ellipsis">
      schemes
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.sqooler.schemes.DropboxLoginInformation" class="md-nav__link">
    <span class="md-ellipsis">
      DropboxLoginInformation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.sqooler.schemes.ExperimentDict" class="md-nav__link">
    <span class="md-ellipsis">
      ExperimentDict
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.sqooler.schemes.GateInstruction" class="md-nav__link">
    <span class="md-ellipsis">
      GateInstruction
    </span>
  </a>
  
    <nav class="md-nav" aria-label="GateInstruction">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.sqooler.schemes.GateInstruction.config_dict" class="md-nav__link">
    <span class="md-ellipsis">
      config_dict()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.sqooler.schemes.LocalLoginInformation" class="md-nav__link">
    <span class="md-ellipsis">
      LocalLoginInformation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.sqooler.schemes.MongodbLoginInformation" class="md-nav__link">
    <span class="md-ellipsis">
      MongodbLoginInformation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.sqooler.schemes.ResultDict" class="md-nav__link">
    <span class="md-ellipsis">
      ResultDict
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.sqooler.schemes.Spooler" class="md-nav__link">
    <span class="md-ellipsis">
      Spooler
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Spooler">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.sqooler.schemes.Spooler.display_name" class="md-nav__link">
    <span class="md-ellipsis">
      display_name
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.sqooler.schemes.Spooler.gen_circuit" class="md-nav__link">
    <span class="md-ellipsis">
      gen_circuit
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.sqooler.schemes.Spooler.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.sqooler.schemes.Spooler.add_job" class="md-nav__link">
    <span class="md-ellipsis">
      add_job()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.sqooler.schemes.Spooler.check_dimension" class="md-nav__link">
    <span class="md-ellipsis">
      check_dimension()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.sqooler.schemes.Spooler.check_experiment" class="md-nav__link">
    <span class="md-ellipsis">
      check_experiment()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.sqooler.schemes.Spooler.check_instructions" class="md-nav__link">
    <span class="md-ellipsis">
      check_instructions()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.sqooler.schemes.Spooler.check_json_dict" class="md-nav__link">
    <span class="md-ellipsis">
      check_json_dict()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.sqooler.schemes.Spooler.get_configuration" class="md-nav__link">
    <span class="md-ellipsis">
      get_configuration()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.sqooler.schemes.create_memory_data" class="md-nav__link">
    <span class="md-ellipsis">
      create_memory_data()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.sqooler.schemes.gate_dict_from_list" class="md-nav__link">
    <span class="md-ellipsis">
      gate_dict_from_list()
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#storage-providers" class="md-nav__link">
    <span class="md-ellipsis">
      Storage Providers
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.sqooler.storage_providers" class="md-nav__link">
    <span class="md-ellipsis">
      storage_providers
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.sqooler.storage_providers.DropboxProvider" class="md-nav__link">
    <span class="md-ellipsis">
      DropboxProvider
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DropboxProvider">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.sqooler.storage_providers.DropboxProvider.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.sqooler.storage_providers.DropboxProvider.delete_file" class="md-nav__link">
    <span class="md-ellipsis">
      delete_file()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.sqooler.storage_providers.DropboxProvider.get_file_content" class="md-nav__link">
    <span class="md-ellipsis">
      get_file_content()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.sqooler.storage_providers.DropboxProvider.get_file_queue" class="md-nav__link">
    <span class="md-ellipsis">
      get_file_queue()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.sqooler.storage_providers.DropboxProvider.get_job_content" class="md-nav__link">
    <span class="md-ellipsis">
      get_job_content()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.sqooler.storage_providers.DropboxProvider.get_next_job_in_queue" class="md-nav__link">
    <span class="md-ellipsis">
      get_next_job_in_queue()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.sqooler.storage_providers.DropboxProvider.move_file" class="md-nav__link">
    <span class="md-ellipsis">
      move_file()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.sqooler.storage_providers.DropboxProvider.update_file" class="md-nav__link">
    <span class="md-ellipsis">
      update_file()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.sqooler.storage_providers.DropboxProvider.update_in_database" class="md-nav__link">
    <span class="md-ellipsis">
      update_in_database()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.sqooler.storage_providers.DropboxProvider.upload" class="md-nav__link">
    <span class="md-ellipsis">
      upload()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.sqooler.storage_providers.DropboxProvider.upload_config" class="md-nav__link">
    <span class="md-ellipsis">
      upload_config()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.sqooler.storage_providers.LocalProvider" class="md-nav__link">
    <span class="md-ellipsis">
      LocalProvider
    </span>
  </a>
  
    <nav class="md-nav" aria-label="LocalProvider">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.sqooler.storage_providers.LocalProvider.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.sqooler.storage_providers.LocalProvider.delete_file" class="md-nav__link">
    <span class="md-ellipsis">
      delete_file()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.sqooler.storage_providers.LocalProvider.get_file_content" class="md-nav__link">
    <span class="md-ellipsis">
      get_file_content()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.sqooler.storage_providers.LocalProvider.get_file_queue" class="md-nav__link">
    <span class="md-ellipsis">
      get_file_queue()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.sqooler.storage_providers.LocalProvider.get_job_content" class="md-nav__link">
    <span class="md-ellipsis">
      get_job_content()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.sqooler.storage_providers.LocalProvider.get_next_job_in_queue" class="md-nav__link">
    <span class="md-ellipsis">
      get_next_job_in_queue()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.sqooler.storage_providers.LocalProvider.move_file" class="md-nav__link">
    <span class="md-ellipsis">
      move_file()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.sqooler.storage_providers.LocalProvider.update_file" class="md-nav__link">
    <span class="md-ellipsis">
      update_file()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.sqooler.storage_providers.LocalProvider.update_in_database" class="md-nav__link">
    <span class="md-ellipsis">
      update_in_database()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.sqooler.storage_providers.LocalProvider.upload" class="md-nav__link">
    <span class="md-ellipsis">
      upload()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.sqooler.storage_providers.LocalProvider.upload_config" class="md-nav__link">
    <span class="md-ellipsis">
      upload_config()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.sqooler.storage_providers.MongodbProvider" class="md-nav__link">
    <span class="md-ellipsis">
      MongodbProvider
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MongodbProvider">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.sqooler.storage_providers.MongodbProvider.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.sqooler.storage_providers.MongodbProvider.delete_file" class="md-nav__link">
    <span class="md-ellipsis">
      delete_file()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.sqooler.storage_providers.MongodbProvider.get_file_content" class="md-nav__link">
    <span class="md-ellipsis">
      get_file_content()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.sqooler.storage_providers.MongodbProvider.get_file_queue" class="md-nav__link">
    <span class="md-ellipsis">
      get_file_queue()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.sqooler.storage_providers.MongodbProvider.get_job_content" class="md-nav__link">
    <span class="md-ellipsis">
      get_job_content()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.sqooler.storage_providers.MongodbProvider.get_next_job_in_queue" class="md-nav__link">
    <span class="md-ellipsis">
      get_next_job_in_queue()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.sqooler.storage_providers.MongodbProvider.move_file" class="md-nav__link">
    <span class="md-ellipsis">
      move_file()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.sqooler.storage_providers.MongodbProvider.update_file" class="md-nav__link">
    <span class="md-ellipsis">
      update_file()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.sqooler.storage_providers.MongodbProvider.update_in_database" class="md-nav__link">
    <span class="md-ellipsis">
      update_in_database()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.sqooler.storage_providers.MongodbProvider.upload" class="md-nav__link">
    <span class="md-ellipsis">
      upload()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.sqooler.storage_providers.MongodbProvider.upload_config" class="md-nav__link">
    <span class="md-ellipsis">
      upload_config()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.sqooler.storage_providers.StorageProvider" class="md-nav__link">
    <span class="md-ellipsis">
      StorageProvider
    </span>
  </a>
  
    <nav class="md-nav" aria-label="StorageProvider">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.sqooler.storage_providers.StorageProvider.delete_file" class="md-nav__link">
    <span class="md-ellipsis">
      delete_file()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.sqooler.storage_providers.StorageProvider.get_file_content" class="md-nav__link">
    <span class="md-ellipsis">
      get_file_content()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.sqooler.storage_providers.StorageProvider.get_file_queue" class="md-nav__link">
    <span class="md-ellipsis">
      get_file_queue()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.sqooler.storage_providers.StorageProvider.get_job_content" class="md-nav__link">
    <span class="md-ellipsis">
      get_job_content()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.sqooler.storage_providers.StorageProvider.get_next_job_in_queue" class="md-nav__link">
    <span class="md-ellipsis">
      get_next_job_in_queue()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.sqooler.storage_providers.StorageProvider.move_file" class="md-nav__link">
    <span class="md-ellipsis">
      move_file()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.sqooler.storage_providers.StorageProvider.update_file" class="md-nav__link">
    <span class="md-ellipsis">
      update_file()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.sqooler.storage_providers.StorageProvider.update_in_database" class="md-nav__link">
    <span class="md-ellipsis">
      update_in_database()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.sqooler.storage_providers.StorageProvider.upload" class="md-nav__link">
    <span class="md-ellipsis">
      upload()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.sqooler.storage_providers.StorageProvider.upload_config" class="md-nav__link">
    <span class="md-ellipsis">
      upload_config()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#schemes" class="md-nav__link">
    <span class="md-ellipsis">
      Schemes
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.sqooler.schemes" class="md-nav__link">
    <span class="md-ellipsis">
      schemes
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.sqooler.schemes.DropboxLoginInformation" class="md-nav__link">
    <span class="md-ellipsis">
      DropboxLoginInformation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.sqooler.schemes.ExperimentDict" class="md-nav__link">
    <span class="md-ellipsis">
      ExperimentDict
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.sqooler.schemes.GateInstruction" class="md-nav__link">
    <span class="md-ellipsis">
      GateInstruction
    </span>
  </a>
  
    <nav class="md-nav" aria-label="GateInstruction">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.sqooler.schemes.GateInstruction.config_dict" class="md-nav__link">
    <span class="md-ellipsis">
      config_dict()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.sqooler.schemes.LocalLoginInformation" class="md-nav__link">
    <span class="md-ellipsis">
      LocalLoginInformation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.sqooler.schemes.MongodbLoginInformation" class="md-nav__link">
    <span class="md-ellipsis">
      MongodbLoginInformation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.sqooler.schemes.ResultDict" class="md-nav__link">
    <span class="md-ellipsis">
      ResultDict
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.sqooler.schemes.Spooler" class="md-nav__link">
    <span class="md-ellipsis">
      Spooler
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Spooler">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.sqooler.schemes.Spooler.display_name" class="md-nav__link">
    <span class="md-ellipsis">
      display_name
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.sqooler.schemes.Spooler.gen_circuit" class="md-nav__link">
    <span class="md-ellipsis">
      gen_circuit
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.sqooler.schemes.Spooler.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.sqooler.schemes.Spooler.add_job" class="md-nav__link">
    <span class="md-ellipsis">
      add_job()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.sqooler.schemes.Spooler.check_dimension" class="md-nav__link">
    <span class="md-ellipsis">
      check_dimension()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.sqooler.schemes.Spooler.check_experiment" class="md-nav__link">
    <span class="md-ellipsis">
      check_experiment()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.sqooler.schemes.Spooler.check_instructions" class="md-nav__link">
    <span class="md-ellipsis">
      check_instructions()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.sqooler.schemes.Spooler.check_json_dict" class="md-nav__link">
    <span class="md-ellipsis">
      check_json_dict()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.sqooler.schemes.Spooler.get_configuration" class="md-nav__link">
    <span class="md-ellipsis">
      get_configuration()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.sqooler.schemes.create_memory_data" class="md-nav__link">
    <span class="md-ellipsis">
      create_memory_data()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.sqooler.schemes.gate_dict_from_list" class="md-nav__link">
    <span class="md-ellipsis">
      gate_dict_from_list()
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="utils">Utils</h1>
<p>This is the module that contains all the basic logic to read the json files that come from <code>qlued</code>. It also allows for validation etc. So if you are not a developer that tries to extend the core behavior of the <code>sqooler</code> it is unlikely that you should modify this part of the code. However, it is instructive to have a look below to understand the  modules that are provided for the creation of a simulator.</p>
<p>Below you can find the API of the <code>utils</code>.</p>
<h2 id="storage-providers">Storage Providers</h2>


<div class="doc doc-object doc-module">



<a id="src.sqooler.storage_providers"></a>
  <div class="doc doc-contents first">
  
      <p>The module that contains all the necessary logic for communication with the external
storage for the jobs. It creates an abstract API layer for the storage providers.</p>

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">




<h2 id="src.sqooler.storage_providers.DropboxProvider" class="doc doc-heading">
          <code>DropboxProvider</code>


</h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="src.sqooler.storage_providers.StorageProvider" href="#src.sqooler.storage_providers.StorageProvider">StorageProvider</a></code></p>

  
      <p>The class that implements the dropbox storage provider.</p>

            <details class="quote">
              <summary>Source code in <code>src/sqooler/storage_providers.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">DropboxProvider</span><span class="p">(</span><span class="n">StorageProvider</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The class that implements the dropbox storage provider.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">login_dict</span><span class="p">:</span> <span class="n">DropboxLoginInformation</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set up the neccessary keys.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">app_key</span> <span class="o">=</span> <span class="n">login_dict</span><span class="o">.</span><span class="n">app_key</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">app_secret</span> <span class="o">=</span> <span class="n">login_dict</span><span class="o">.</span><span class="n">app_secret</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refresh_token</span> <span class="o">=</span> <span class="n">login_dict</span><span class="o">.</span><span class="n">refresh_token</span>

    <span class="k">def</span> <span class="nf">upload</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content_dict</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">,</span> <span class="n">storage_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">job_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Upload the content_dict as a json file to the dropbox</span>

<span class="sd">        Args:</span>
<span class="sd">            content_dict: the content of the file that should be uploaded</span>
<span class="sd">            storage_path: the path where the file should be stored, but excluding the file name</span>
<span class="sd">            job_id: the name of the file without the .json extension</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># create the appropriate string for the dropbox API</span>
        <span class="n">dump_str</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">content_dict</span><span class="p">)</span>

        <span class="c1"># strip trailing and leading slashes from the storage_path</span>
        <span class="n">storage_path</span> <span class="o">=</span> <span class="n">storage_path</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span>

        <span class="c1"># create the full path</span>
        <span class="n">full_path</span> <span class="o">=</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">storage_path</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">job_id</span> <span class="o">+</span> <span class="s2">&quot;.json&quot;</span>

        <span class="c1"># Create an instance of a Dropbox class, which can make requests to the API.</span>
        <span class="k">with</span> <span class="n">dropbox</span><span class="o">.</span><span class="n">Dropbox</span><span class="p">(</span>
            <span class="n">app_key</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">app_key</span><span class="p">,</span>
            <span class="n">app_secret</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">app_secret</span><span class="p">,</span>
            <span class="n">oauth2_refresh_token</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">refresh_token</span><span class="p">,</span>
        <span class="p">)</span> <span class="k">as</span> <span class="n">dbx</span><span class="p">:</span>
            <span class="c1"># Check that the access token is valid</span>
            <span class="n">dbx</span><span class="o">.</span><span class="n">users_get_current_account</span><span class="p">()</span>
            <span class="n">dbx</span><span class="o">.</span><span class="n">files_upload</span><span class="p">(</span>
                <span class="n">dump_str</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">),</span> <span class="n">full_path</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">WriteMode</span><span class="p">(</span><span class="s2">&quot;overwrite&quot;</span><span class="p">)</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_file_content</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">storage_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">job_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the file content from the dropbox</span>

<span class="sd">        storage_path: the path where the file should be stored, but excluding the file name</span>
<span class="sd">        job_id: the name of the file. Is a json file</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># strip trailing and leading slashes from the storage_path</span>
        <span class="n">storage_path</span> <span class="o">=</span> <span class="n">storage_path</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span>

        <span class="c1"># Create an instance of a Dropbox class, which can make requests to the API.</span>
        <span class="k">with</span> <span class="n">dropbox</span><span class="o">.</span><span class="n">Dropbox</span><span class="p">(</span>
            <span class="n">app_key</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">app_key</span><span class="p">,</span>
            <span class="n">app_secret</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">app_secret</span><span class="p">,</span>
            <span class="n">oauth2_refresh_token</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">refresh_token</span><span class="p">,</span>
        <span class="p">)</span> <span class="k">as</span> <span class="n">dbx</span><span class="p">:</span>
            <span class="c1"># Check that the access token is valid</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">dbx</span><span class="o">.</span><span class="n">users_get_current_account</span><span class="p">()</span>
            <span class="k">except</span> <span class="n">AuthError</span><span class="p">:</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="s2">&quot;ERROR: Invalid access token.&quot;</span><span class="p">)</span>
            <span class="n">full_path</span> <span class="o">=</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">storage_path</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">job_id</span> <span class="o">+</span> <span class="s2">&quot;.json&quot;</span>
            <span class="n">_</span><span class="p">,</span> <span class="n">res</span> <span class="o">=</span> <span class="n">dbx</span><span class="o">.</span><span class="n">files_download</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">full_path</span><span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">content</span>
        <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">get_job_content</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">storage_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">job_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the content of the job from the storage. This is a wrapper around get_file_content</span>
<span class="sd">        and and handles the different ways of identifiying the job.</span>

<span class="sd">        storage_path: the path towards the file, excluding the filename / id</span>
<span class="sd">        job_id: the id of the file we are about to look up</span>

<span class="sd">        Returns:</span>
<span class="sd">            The content of the job</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_file_content</span><span class="p">(</span><span class="n">storage_path</span><span class="o">=</span><span class="n">storage_path</span><span class="p">,</span> <span class="n">job_id</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;job-</span><span class="si">{</span><span class="n">job_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">update_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">storage_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">job_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Update the file content.</span>

<span class="sd">        Args:</span>
<span class="sd">            content_dict: The dictionary containing the new content of the file</span>
<span class="sd">            storage_path: The path to the file</span>
<span class="sd">            job_id: The id of the job</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># create the appropriate string for the dropbox API</span>
        <span class="n">dump_str</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">content_dict</span><span class="p">)</span>

        <span class="c1"># strip trailing and leading slashes from the storage_path</span>
        <span class="n">storage_path</span> <span class="o">=</span> <span class="n">storage_path</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span>

        <span class="c1"># create the full path</span>
        <span class="n">full_path</span> <span class="o">=</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">storage_path</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">job_id</span> <span class="o">+</span> <span class="s2">&quot;.json&quot;</span>

        <span class="c1"># Create an instance of a Dropbox class, which can make requests to the API.</span>
        <span class="k">with</span> <span class="n">dropbox</span><span class="o">.</span><span class="n">Dropbox</span><span class="p">(</span>
            <span class="n">app_key</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">app_key</span><span class="p">,</span>
            <span class="n">app_secret</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">app_secret</span><span class="p">,</span>
            <span class="n">oauth2_refresh_token</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">refresh_token</span><span class="p">,</span>
        <span class="p">)</span> <span class="k">as</span> <span class="n">dbx</span><span class="p">:</span>
            <span class="c1"># Check that the access token is valid</span>
            <span class="n">dbx</span><span class="o">.</span><span class="n">users_get_current_account</span><span class="p">()</span>
            <span class="n">dbx</span><span class="o">.</span><span class="n">files_upload</span><span class="p">(</span>
                <span class="n">dump_str</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">),</span> <span class="n">full_path</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">WriteMode</span><span class="p">(</span><span class="s2">&quot;overwrite&quot;</span><span class="p">)</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="nf">move_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">final_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">job_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Move the file from start_path to final_path</span>

<span class="sd">        start_path: the path where the file is currently stored, but excluding the file name</span>
<span class="sd">        final_path: the path where the file should be stored, but excluding the file name</span>
<span class="sd">        job_id: the name of the file. Is a json file</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># strip trailing and leading slashes from the paths</span>
        <span class="n">start_path</span> <span class="o">=</span> <span class="n">start_path</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span>
        <span class="n">final_path</span> <span class="o">=</span> <span class="n">final_path</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span>

        <span class="c1"># Create an instance of a Dropbox class, which can make requests to the API.</span>
        <span class="k">with</span> <span class="n">dropbox</span><span class="o">.</span><span class="n">Dropbox</span><span class="p">(</span>
            <span class="n">app_key</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">app_key</span><span class="p">,</span>
            <span class="n">app_secret</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">app_secret</span><span class="p">,</span>
            <span class="n">oauth2_refresh_token</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">refresh_token</span><span class="p">,</span>
        <span class="p">)</span> <span class="k">as</span> <span class="n">dbx</span><span class="p">:</span>
            <span class="n">dbx</span><span class="o">.</span><span class="n">users_get_current_account</span><span class="p">()</span>

            <span class="n">full_start_path</span> <span class="o">=</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">start_path</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">job_id</span> <span class="o">+</span> <span class="s2">&quot;.json&quot;</span>
            <span class="n">full_final_path</span> <span class="o">=</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">final_path</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">job_id</span> <span class="o">+</span> <span class="s2">&quot;.json&quot;</span>
            <span class="n">dbx</span><span class="o">.</span><span class="n">files_move_v2</span><span class="p">(</span><span class="n">full_start_path</span><span class="p">,</span> <span class="n">full_final_path</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">delete_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">storage_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">job_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Remove the file from the dropbox</span>

<span class="sd">        Args:</span>
<span class="sd">            storage_path: the path where the file should be stored, but excluding the file name</span>
<span class="sd">            job_id: the name of the file. Is a json file</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># strip trailing and leading slashes from the storage_path</span>
        <span class="n">storage_path</span> <span class="o">=</span> <span class="n">storage_path</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span>

        <span class="c1"># Create an instance of a Dropbox class, which can make requests to the API.</span>
        <span class="k">with</span> <span class="n">dropbox</span><span class="o">.</span><span class="n">Dropbox</span><span class="p">(</span>
            <span class="n">app_key</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">app_key</span><span class="p">,</span>
            <span class="n">app_secret</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">app_secret</span><span class="p">,</span>
            <span class="n">oauth2_refresh_token</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">refresh_token</span><span class="p">,</span>
        <span class="p">)</span> <span class="k">as</span> <span class="n">dbx</span><span class="p">:</span>
            <span class="c1"># Check that the access token is valid</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">dbx</span><span class="o">.</span><span class="n">users_get_current_account</span><span class="p">()</span>
            <span class="k">except</span> <span class="n">AuthError</span><span class="p">:</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="s2">&quot;ERROR: Invalid access token.&quot;</span><span class="p">)</span>

            <span class="n">full_path</span> <span class="o">=</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">storage_path</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">job_id</span> <span class="o">+</span> <span class="s2">&quot;.json&quot;</span>
            <span class="n">_</span> <span class="o">=</span> <span class="n">dbx</span><span class="o">.</span><span class="n">files_delete</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">full_path</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">upload_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">backend_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The function that uploads the spooler configuration to the storage.</span>

<span class="sd">        All the configurations are stored in the Backend_files/Config folder.</span>
<span class="sd">        For each backend there is a separate folder in which the configuration is stored as a json file.</span>

<span class="sd">        Args:</span>
<span class="sd">            config_dict: The dictionary containing the configuration</span>
<span class="sd">            backend_name (str): The name of the backend</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">config_path</span> <span class="o">=</span> <span class="s2">&quot;Backend_files/Config/&quot;</span> <span class="o">+</span> <span class="n">backend_name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">upload</span><span class="p">(</span><span class="n">config_dict</span><span class="p">,</span> <span class="n">config_path</span><span class="p">,</span> <span class="s2">&quot;config&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">update_in_database</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">result_dict</span><span class="p">:</span> <span class="n">ResultDict</span><span class="p">,</span>
        <span class="n">status_msg_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
        <span class="n">job_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">backend_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Upload the status and result to the dropbox.</span>

<span class="sd">        Args:</span>
<span class="sd">            result_dict: the dictionary containing the result of the job</span>
<span class="sd">            status_msg_dict: the dictionary containing the status message of the job</span>
<span class="sd">            job_id: the name of the job</span>
<span class="sd">            backend_name: the name of the backend</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># this should become part of the json file instead of its name in the future</span>
        <span class="n">extracted_username</span> <span class="o">=</span> <span class="n">job_id</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span>

        <span class="n">status_json_dir</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;/Backend_files/Status/&quot;</span> <span class="o">+</span> <span class="n">backend_name</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">extracted_username</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span>
        <span class="p">)</span>
        <span class="n">status_json_name</span> <span class="o">=</span> <span class="s2">&quot;status-&quot;</span> <span class="o">+</span> <span class="n">job_id</span>

        <span class="n">job_json_name</span> <span class="o">=</span> <span class="s2">&quot;job-&quot;</span> <span class="o">+</span> <span class="n">job_id</span>
        <span class="n">job_json_start_dir</span> <span class="o">=</span> <span class="s2">&quot;Backend_files/Running_Jobs&quot;</span>

        <span class="k">if</span> <span class="n">status_msg_dict</span><span class="p">[</span><span class="s2">&quot;status&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;DONE&quot;</span><span class="p">:</span>
            <span class="c1"># let us create the result json file</span>
            <span class="n">result_json_dir</span> <span class="o">=</span> <span class="p">(</span>
                <span class="s2">&quot;/Backend_files/Result/&quot;</span> <span class="o">+</span> <span class="n">backend_name</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">extracted_username</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span>
            <span class="p">)</span>
            <span class="n">result_json_name</span> <span class="o">=</span> <span class="s2">&quot;result-&quot;</span> <span class="o">+</span> <span class="n">job_id</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">upload</span><span class="p">(</span><span class="n">result_dict</span><span class="p">,</span> <span class="n">result_json_dir</span><span class="p">,</span> <span class="n">result_json_name</span><span class="p">)</span>

            <span class="c1"># now move the job out of the running jobs into the finished jobs</span>
            <span class="n">job_finished_json_dir</span> <span class="o">=</span> <span class="p">(</span>
                <span class="s2">&quot;/Backend_files/Finished_Jobs/&quot;</span>
                <span class="o">+</span> <span class="n">backend_name</span>
                <span class="o">+</span> <span class="s2">&quot;/&quot;</span>
                <span class="o">+</span> <span class="n">extracted_username</span>
                <span class="o">+</span> <span class="s2">&quot;/&quot;</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">move_file</span><span class="p">(</span><span class="n">job_json_start_dir</span><span class="p">,</span> <span class="n">job_finished_json_dir</span><span class="p">,</span> <span class="n">job_json_name</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">status_msg_dict</span><span class="p">[</span><span class="s2">&quot;status&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;ERROR&quot;</span><span class="p">:</span>
            <span class="c1"># because there was an error, we move the job to the deleted jobs</span>
            <span class="n">deleted_json_dir</span> <span class="o">=</span> <span class="s2">&quot;Backend_files/Deleted_Jobs&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">move_file</span><span class="p">(</span><span class="n">job_json_start_dir</span><span class="p">,</span> <span class="n">deleted_json_dir</span><span class="p">,</span> <span class="n">job_json_name</span><span class="p">)</span>

        <span class="c1"># and create the status json file</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">upload</span><span class="p">(</span><span class="n">status_msg_dict</span><span class="p">,</span> <span class="n">status_json_dir</span><span class="p">,</span> <span class="n">status_json_name</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_file_queue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">storage_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get a list of files. Typically we are looking for the queued jobs of a backend here.</span>

<span class="sd">        Args:</span>
<span class="sd">            storage_path: Where are we looking for the files.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A list of files that was found.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># strip trailing and leading slashes from the paths</span>
        <span class="n">storage_path</span> <span class="o">=</span> <span class="n">storage_path</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span>

        <span class="n">storage_path</span> <span class="o">=</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">storage_path</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span>

        <span class="c1"># Create an instance of a Dropbox class, which can make requests to the API.</span>
        <span class="n">file_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">with</span> <span class="n">dropbox</span><span class="o">.</span><span class="n">Dropbox</span><span class="p">(</span>
            <span class="n">app_key</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">app_key</span><span class="p">,</span>
            <span class="n">app_secret</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">app_secret</span><span class="p">,</span>
            <span class="n">oauth2_refresh_token</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">refresh_token</span><span class="p">,</span>
        <span class="p">)</span> <span class="k">as</span> <span class="n">dbx</span><span class="p">:</span>
            <span class="c1"># Check that the access token is valid</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">dbx</span><span class="o">.</span><span class="n">users_get_current_account</span><span class="p">()</span>
            <span class="k">except</span> <span class="n">AuthError</span><span class="p">:</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="s2">&quot;ERROR: Invalid access token.&quot;</span><span class="p">)</span>
            <span class="c1"># We should really handle these exceptions cleaner, but this seems a bit</span>
            <span class="c1"># complicated right now</span>
            <span class="c1"># pylint: disable=W0703</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">response</span> <span class="o">=</span> <span class="n">dbx</span><span class="o">.</span><span class="n">files_list_folder</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">storage_path</span><span class="p">)</span>
                <span class="n">file_list</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">entries</span>
                <span class="n">file_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">file_list</span><span class="p">]</span>
            <span class="k">except</span> <span class="n">ApiError</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Could not obtain job queue for </span><span class="si">{</span><span class="n">storage_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">file_list</span>

    <span class="k">def</span> <span class="nf">get_next_job_in_queue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">backend_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A function that obtains the next job in the queue.</span>

<span class="sd">        Args:</span>
<span class="sd">            backend_name (str): The name of the backend</span>

<span class="sd">        Returns:</span>
<span class="sd">            the path towards the job</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">job_json_dir</span> <span class="o">=</span> <span class="s2">&quot;/Backend_files/Queued_Jobs/&quot;</span> <span class="o">+</span> <span class="n">backend_name</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span>
        <span class="n">job_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;job_id&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;job_json_path&quot;</span><span class="p">:</span> <span class="s2">&quot;None&quot;</span><span class="p">}</span>
        <span class="n">job_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_file_queue</span><span class="p">(</span><span class="n">job_json_dir</span><span class="p">)</span>
        <span class="c1"># if there is a job, we should move it</span>
        <span class="k">if</span> <span class="n">job_list</span><span class="p">:</span>
            <span class="n">job_json_name</span> <span class="o">=</span> <span class="n">job_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">job_dict</span><span class="p">[</span><span class="s2">&quot;job_id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">job_json_name</span><span class="p">[</span><span class="mi">4</span><span class="p">:</span><span class="o">-</span><span class="mi">5</span><span class="p">]</span>

            <span class="c1"># split the .json from the job_json_name</span>
            <span class="n">job_json_name</span> <span class="o">=</span> <span class="n">job_json_name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="c1"># and move the file into the right directory</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">move_file</span><span class="p">(</span><span class="n">job_json_dir</span><span class="p">,</span> <span class="s2">&quot;Backend_files/Running_Jobs&quot;</span><span class="p">,</span> <span class="n">job_json_name</span><span class="p">)</span>
            <span class="n">job_dict</span><span class="p">[</span><span class="s2">&quot;job_json_path&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Backend_files/Running_Jobs&quot;</span>
        <span class="k">return</span> <span class="n">job_dict</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h3 id="src.sqooler.storage_providers.DropboxProvider.__init__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">login_dict</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Set up the neccessary keys.</p>

          <details class="quote">
            <summary>Source code in <code>src/sqooler/storage_providers.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">login_dict</span><span class="p">:</span> <span class="n">DropboxLoginInformation</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Set up the neccessary keys.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">app_key</span> <span class="o">=</span> <span class="n">login_dict</span><span class="o">.</span><span class="n">app_key</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">app_secret</span> <span class="o">=</span> <span class="n">login_dict</span><span class="o">.</span><span class="n">app_secret</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">refresh_token</span> <span class="o">=</span> <span class="n">login_dict</span><span class="o">.</span><span class="n">refresh_token</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="src.sqooler.storage_providers.DropboxProvider.delete_file" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">delete_file</span><span class="p">(</span><span class="n">storage_path</span><span class="p">,</span> <span class="n">job_id</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Remove the file from the dropbox</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>storage_path</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the path where the file should be stored, but excluding the file name</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>job_id</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the name of the file. Is a json file</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>None</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/sqooler/storage_providers.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">delete_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">storage_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">job_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Remove the file from the dropbox</span>

<span class="sd">    Args:</span>
<span class="sd">        storage_path: the path where the file should be stored, but excluding the file name</span>
<span class="sd">        job_id: the name of the file. Is a json file</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># strip trailing and leading slashes from the storage_path</span>
    <span class="n">storage_path</span> <span class="o">=</span> <span class="n">storage_path</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span>

    <span class="c1"># Create an instance of a Dropbox class, which can make requests to the API.</span>
    <span class="k">with</span> <span class="n">dropbox</span><span class="o">.</span><span class="n">Dropbox</span><span class="p">(</span>
        <span class="n">app_key</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">app_key</span><span class="p">,</span>
        <span class="n">app_secret</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">app_secret</span><span class="p">,</span>
        <span class="n">oauth2_refresh_token</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">refresh_token</span><span class="p">,</span>
    <span class="p">)</span> <span class="k">as</span> <span class="n">dbx</span><span class="p">:</span>
        <span class="c1"># Check that the access token is valid</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">dbx</span><span class="o">.</span><span class="n">users_get_current_account</span><span class="p">()</span>
        <span class="k">except</span> <span class="n">AuthError</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="s2">&quot;ERROR: Invalid access token.&quot;</span><span class="p">)</span>

        <span class="n">full_path</span> <span class="o">=</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">storage_path</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">job_id</span> <span class="o">+</span> <span class="s2">&quot;.json&quot;</span>
        <span class="n">_</span> <span class="o">=</span> <span class="n">dbx</span><span class="o">.</span><span class="n">files_delete</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">full_path</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="src.sqooler.storage_providers.DropboxProvider.get_file_content" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_file_content</span><span class="p">(</span><span class="n">storage_path</span><span class="p">,</span> <span class="n">job_id</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Get the file content from the dropbox</p>
<p>storage_path: the path where the file should be stored, but excluding the file name
job_id: the name of the file. Is a json file</p>

          <details class="quote">
            <summary>Source code in <code>src/sqooler/storage_providers.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_file_content</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">storage_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">job_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the file content from the dropbox</span>

<span class="sd">    storage_path: the path where the file should be stored, but excluding the file name</span>
<span class="sd">    job_id: the name of the file. Is a json file</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># strip trailing and leading slashes from the storage_path</span>
    <span class="n">storage_path</span> <span class="o">=</span> <span class="n">storage_path</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span>

    <span class="c1"># Create an instance of a Dropbox class, which can make requests to the API.</span>
    <span class="k">with</span> <span class="n">dropbox</span><span class="o">.</span><span class="n">Dropbox</span><span class="p">(</span>
        <span class="n">app_key</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">app_key</span><span class="p">,</span>
        <span class="n">app_secret</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">app_secret</span><span class="p">,</span>
        <span class="n">oauth2_refresh_token</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">refresh_token</span><span class="p">,</span>
    <span class="p">)</span> <span class="k">as</span> <span class="n">dbx</span><span class="p">:</span>
        <span class="c1"># Check that the access token is valid</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">dbx</span><span class="o">.</span><span class="n">users_get_current_account</span><span class="p">()</span>
        <span class="k">except</span> <span class="n">AuthError</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="s2">&quot;ERROR: Invalid access token.&quot;</span><span class="p">)</span>
        <span class="n">full_path</span> <span class="o">=</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">storage_path</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">job_id</span> <span class="o">+</span> <span class="s2">&quot;.json&quot;</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">res</span> <span class="o">=</span> <span class="n">dbx</span><span class="o">.</span><span class="n">files_download</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">full_path</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">content</span>
    <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="src.sqooler.storage_providers.DropboxProvider.get_file_queue" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_file_queue</span><span class="p">(</span><span class="n">storage_path</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Get a list of files. Typically we are looking for the queued jobs of a backend here.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>storage_path</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Where are we looking for the files.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>list[str]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A list of files that was found.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/sqooler/storage_providers.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_file_queue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">storage_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get a list of files. Typically we are looking for the queued jobs of a backend here.</span>

<span class="sd">    Args:</span>
<span class="sd">        storage_path: Where are we looking for the files.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A list of files that was found.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># strip trailing and leading slashes from the paths</span>
    <span class="n">storage_path</span> <span class="o">=</span> <span class="n">storage_path</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span>

    <span class="n">storage_path</span> <span class="o">=</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">storage_path</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span>

    <span class="c1"># Create an instance of a Dropbox class, which can make requests to the API.</span>
    <span class="n">file_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">with</span> <span class="n">dropbox</span><span class="o">.</span><span class="n">Dropbox</span><span class="p">(</span>
        <span class="n">app_key</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">app_key</span><span class="p">,</span>
        <span class="n">app_secret</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">app_secret</span><span class="p">,</span>
        <span class="n">oauth2_refresh_token</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">refresh_token</span><span class="p">,</span>
    <span class="p">)</span> <span class="k">as</span> <span class="n">dbx</span><span class="p">:</span>
        <span class="c1"># Check that the access token is valid</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">dbx</span><span class="o">.</span><span class="n">users_get_current_account</span><span class="p">()</span>
        <span class="k">except</span> <span class="n">AuthError</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="s2">&quot;ERROR: Invalid access token.&quot;</span><span class="p">)</span>
        <span class="c1"># We should really handle these exceptions cleaner, but this seems a bit</span>
        <span class="c1"># complicated right now</span>
        <span class="c1"># pylint: disable=W0703</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="n">dbx</span><span class="o">.</span><span class="n">files_list_folder</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">storage_path</span><span class="p">)</span>
            <span class="n">file_list</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">entries</span>
            <span class="n">file_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">file_list</span><span class="p">]</span>
        <span class="k">except</span> <span class="n">ApiError</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Could not obtain job queue for </span><span class="si">{</span><span class="n">storage_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">file_list</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="src.sqooler.storage_providers.DropboxProvider.get_job_content" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_job_content</span><span class="p">(</span><span class="n">storage_path</span><span class="p">,</span> <span class="n">job_id</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Get the content of the job from the storage. This is a wrapper around get_file_content
and and handles the different ways of identifiying the job.</p>
<p>storage_path: the path towards the file, excluding the filename / id
job_id: the id of the file we are about to look up</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The content of the job</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/sqooler/storage_providers.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_job_content</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">storage_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">job_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the content of the job from the storage. This is a wrapper around get_file_content</span>
<span class="sd">    and and handles the different ways of identifiying the job.</span>

<span class="sd">    storage_path: the path towards the file, excluding the filename / id</span>
<span class="sd">    job_id: the id of the file we are about to look up</span>

<span class="sd">    Returns:</span>
<span class="sd">        The content of the job</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_file_content</span><span class="p">(</span><span class="n">storage_path</span><span class="o">=</span><span class="n">storage_path</span><span class="p">,</span> <span class="n">job_id</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;job-</span><span class="si">{</span><span class="n">job_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="src.sqooler.storage_providers.DropboxProvider.get_next_job_in_queue" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_next_job_in_queue</span><span class="p">(</span><span class="n">backend_name</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>A function that obtains the next job in the queue.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>backend_name</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The name of the backend</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the path towards the job</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/sqooler/storage_providers.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_next_job_in_queue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">backend_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A function that obtains the next job in the queue.</span>

<span class="sd">    Args:</span>
<span class="sd">        backend_name (str): The name of the backend</span>

<span class="sd">    Returns:</span>
<span class="sd">        the path towards the job</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">job_json_dir</span> <span class="o">=</span> <span class="s2">&quot;/Backend_files/Queued_Jobs/&quot;</span> <span class="o">+</span> <span class="n">backend_name</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span>
    <span class="n">job_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;job_id&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;job_json_path&quot;</span><span class="p">:</span> <span class="s2">&quot;None&quot;</span><span class="p">}</span>
    <span class="n">job_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_file_queue</span><span class="p">(</span><span class="n">job_json_dir</span><span class="p">)</span>
    <span class="c1"># if there is a job, we should move it</span>
    <span class="k">if</span> <span class="n">job_list</span><span class="p">:</span>
        <span class="n">job_json_name</span> <span class="o">=</span> <span class="n">job_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">job_dict</span><span class="p">[</span><span class="s2">&quot;job_id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">job_json_name</span><span class="p">[</span><span class="mi">4</span><span class="p">:</span><span class="o">-</span><span class="mi">5</span><span class="p">]</span>

        <span class="c1"># split the .json from the job_json_name</span>
        <span class="n">job_json_name</span> <span class="o">=</span> <span class="n">job_json_name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="c1"># and move the file into the right directory</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">move_file</span><span class="p">(</span><span class="n">job_json_dir</span><span class="p">,</span> <span class="s2">&quot;Backend_files/Running_Jobs&quot;</span><span class="p">,</span> <span class="n">job_json_name</span><span class="p">)</span>
        <span class="n">job_dict</span><span class="p">[</span><span class="s2">&quot;job_json_path&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Backend_files/Running_Jobs&quot;</span>
    <span class="k">return</span> <span class="n">job_dict</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="src.sqooler.storage_providers.DropboxProvider.move_file" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">move_file</span><span class="p">(</span><span class="n">start_path</span><span class="p">,</span> <span class="n">final_path</span><span class="p">,</span> <span class="n">job_id</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Move the file from start_path to final_path</p>
<p>start_path: the path where the file is currently stored, but excluding the file name
final_path: the path where the file should be stored, but excluding the file name
job_id: the name of the file. Is a json file</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>None</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/sqooler/storage_providers.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">move_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">final_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">job_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Move the file from start_path to final_path</span>

<span class="sd">    start_path: the path where the file is currently stored, but excluding the file name</span>
<span class="sd">    final_path: the path where the file should be stored, but excluding the file name</span>
<span class="sd">    job_id: the name of the file. Is a json file</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># strip trailing and leading slashes from the paths</span>
    <span class="n">start_path</span> <span class="o">=</span> <span class="n">start_path</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span>
    <span class="n">final_path</span> <span class="o">=</span> <span class="n">final_path</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span>

    <span class="c1"># Create an instance of a Dropbox class, which can make requests to the API.</span>
    <span class="k">with</span> <span class="n">dropbox</span><span class="o">.</span><span class="n">Dropbox</span><span class="p">(</span>
        <span class="n">app_key</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">app_key</span><span class="p">,</span>
        <span class="n">app_secret</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">app_secret</span><span class="p">,</span>
        <span class="n">oauth2_refresh_token</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">refresh_token</span><span class="p">,</span>
    <span class="p">)</span> <span class="k">as</span> <span class="n">dbx</span><span class="p">:</span>
        <span class="n">dbx</span><span class="o">.</span><span class="n">users_get_current_account</span><span class="p">()</span>

        <span class="n">full_start_path</span> <span class="o">=</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">start_path</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">job_id</span> <span class="o">+</span> <span class="s2">&quot;.json&quot;</span>
        <span class="n">full_final_path</span> <span class="o">=</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">final_path</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">job_id</span> <span class="o">+</span> <span class="s2">&quot;.json&quot;</span>
        <span class="n">dbx</span><span class="o">.</span><span class="n">files_move_v2</span><span class="p">(</span><span class="n">full_start_path</span><span class="p">,</span> <span class="n">full_final_path</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="src.sqooler.storage_providers.DropboxProvider.update_file" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">update_file</span><span class="p">(</span><span class="n">content_dict</span><span class="p">,</span> <span class="n">storage_path</span><span class="p">,</span> <span class="n">job_id</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Update the file content.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>content_dict</code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The dictionary containing the new content of the file</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>storage_path</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The path to the file</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>job_id</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The id of the job</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>None</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/sqooler/storage_providers.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">update_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">storage_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">job_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Update the file content.</span>

<span class="sd">    Args:</span>
<span class="sd">        content_dict: The dictionary containing the new content of the file</span>
<span class="sd">        storage_path: The path to the file</span>
<span class="sd">        job_id: The id of the job</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># create the appropriate string for the dropbox API</span>
    <span class="n">dump_str</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">content_dict</span><span class="p">)</span>

    <span class="c1"># strip trailing and leading slashes from the storage_path</span>
    <span class="n">storage_path</span> <span class="o">=</span> <span class="n">storage_path</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span>

    <span class="c1"># create the full path</span>
    <span class="n">full_path</span> <span class="o">=</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">storage_path</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">job_id</span> <span class="o">+</span> <span class="s2">&quot;.json&quot;</span>

    <span class="c1"># Create an instance of a Dropbox class, which can make requests to the API.</span>
    <span class="k">with</span> <span class="n">dropbox</span><span class="o">.</span><span class="n">Dropbox</span><span class="p">(</span>
        <span class="n">app_key</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">app_key</span><span class="p">,</span>
        <span class="n">app_secret</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">app_secret</span><span class="p">,</span>
        <span class="n">oauth2_refresh_token</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">refresh_token</span><span class="p">,</span>
    <span class="p">)</span> <span class="k">as</span> <span class="n">dbx</span><span class="p">:</span>
        <span class="c1"># Check that the access token is valid</span>
        <span class="n">dbx</span><span class="o">.</span><span class="n">users_get_current_account</span><span class="p">()</span>
        <span class="n">dbx</span><span class="o">.</span><span class="n">files_upload</span><span class="p">(</span>
            <span class="n">dump_str</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">),</span> <span class="n">full_path</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">WriteMode</span><span class="p">(</span><span class="s2">&quot;overwrite&quot;</span><span class="p">)</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="src.sqooler.storage_providers.DropboxProvider.update_in_database" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">update_in_database</span><span class="p">(</span><span class="n">result_dict</span><span class="p">,</span> <span class="n">status_msg_dict</span><span class="p">,</span> <span class="n">job_id</span><span class="p">,</span> <span class="n">backend_name</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Upload the status and result to the dropbox.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>result_dict</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="src.sqooler.schemes.ResultDict" href="#src.sqooler.schemes.ResultDict">ResultDict</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the dictionary containing the result of the job</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>status_msg_dict</code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the dictionary containing the status message of the job</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>job_id</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the name of the job</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>backend_name</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the name of the backend</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>None</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/sqooler/storage_providers.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">update_in_database</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">result_dict</span><span class="p">:</span> <span class="n">ResultDict</span><span class="p">,</span>
    <span class="n">status_msg_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
    <span class="n">job_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">backend_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Upload the status and result to the dropbox.</span>

<span class="sd">    Args:</span>
<span class="sd">        result_dict: the dictionary containing the result of the job</span>
<span class="sd">        status_msg_dict: the dictionary containing the status message of the job</span>
<span class="sd">        job_id: the name of the job</span>
<span class="sd">        backend_name: the name of the backend</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># this should become part of the json file instead of its name in the future</span>
    <span class="n">extracted_username</span> <span class="o">=</span> <span class="n">job_id</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span>

    <span class="n">status_json_dir</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">&quot;/Backend_files/Status/&quot;</span> <span class="o">+</span> <span class="n">backend_name</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">extracted_username</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span>
    <span class="p">)</span>
    <span class="n">status_json_name</span> <span class="o">=</span> <span class="s2">&quot;status-&quot;</span> <span class="o">+</span> <span class="n">job_id</span>

    <span class="n">job_json_name</span> <span class="o">=</span> <span class="s2">&quot;job-&quot;</span> <span class="o">+</span> <span class="n">job_id</span>
    <span class="n">job_json_start_dir</span> <span class="o">=</span> <span class="s2">&quot;Backend_files/Running_Jobs&quot;</span>

    <span class="k">if</span> <span class="n">status_msg_dict</span><span class="p">[</span><span class="s2">&quot;status&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;DONE&quot;</span><span class="p">:</span>
        <span class="c1"># let us create the result json file</span>
        <span class="n">result_json_dir</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;/Backend_files/Result/&quot;</span> <span class="o">+</span> <span class="n">backend_name</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">extracted_username</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span>
        <span class="p">)</span>
        <span class="n">result_json_name</span> <span class="o">=</span> <span class="s2">&quot;result-&quot;</span> <span class="o">+</span> <span class="n">job_id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">upload</span><span class="p">(</span><span class="n">result_dict</span><span class="p">,</span> <span class="n">result_json_dir</span><span class="p">,</span> <span class="n">result_json_name</span><span class="p">)</span>

        <span class="c1"># now move the job out of the running jobs into the finished jobs</span>
        <span class="n">job_finished_json_dir</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;/Backend_files/Finished_Jobs/&quot;</span>
            <span class="o">+</span> <span class="n">backend_name</span>
            <span class="o">+</span> <span class="s2">&quot;/&quot;</span>
            <span class="o">+</span> <span class="n">extracted_username</span>
            <span class="o">+</span> <span class="s2">&quot;/&quot;</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">move_file</span><span class="p">(</span><span class="n">job_json_start_dir</span><span class="p">,</span> <span class="n">job_finished_json_dir</span><span class="p">,</span> <span class="n">job_json_name</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">status_msg_dict</span><span class="p">[</span><span class="s2">&quot;status&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;ERROR&quot;</span><span class="p">:</span>
        <span class="c1"># because there was an error, we move the job to the deleted jobs</span>
        <span class="n">deleted_json_dir</span> <span class="o">=</span> <span class="s2">&quot;Backend_files/Deleted_Jobs&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">move_file</span><span class="p">(</span><span class="n">job_json_start_dir</span><span class="p">,</span> <span class="n">deleted_json_dir</span><span class="p">,</span> <span class="n">job_json_name</span><span class="p">)</span>

    <span class="c1"># and create the status json file</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">upload</span><span class="p">(</span><span class="n">status_msg_dict</span><span class="p">,</span> <span class="n">status_json_dir</span><span class="p">,</span> <span class="n">status_json_name</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="src.sqooler.storage_providers.DropboxProvider.upload" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">upload</span><span class="p">(</span><span class="n">content_dict</span><span class="p">,</span> <span class="n">storage_path</span><span class="p">,</span> <span class="n">job_id</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Upload the content_dict as a json file to the dropbox</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>content_dict</code></td>
          <td>
                <code><span title="typing.Mapping">Mapping</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the content of the file that should be uploaded</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>storage_path</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the path where the file should be stored, but excluding the file name</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>job_id</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the name of the file without the .json extension</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/sqooler/storage_providers.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">upload</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content_dict</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">,</span> <span class="n">storage_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">job_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Upload the content_dict as a json file to the dropbox</span>

<span class="sd">    Args:</span>
<span class="sd">        content_dict: the content of the file that should be uploaded</span>
<span class="sd">        storage_path: the path where the file should be stored, but excluding the file name</span>
<span class="sd">        job_id: the name of the file without the .json extension</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># create the appropriate string for the dropbox API</span>
    <span class="n">dump_str</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">content_dict</span><span class="p">)</span>

    <span class="c1"># strip trailing and leading slashes from the storage_path</span>
    <span class="n">storage_path</span> <span class="o">=</span> <span class="n">storage_path</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span>

    <span class="c1"># create the full path</span>
    <span class="n">full_path</span> <span class="o">=</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">storage_path</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">job_id</span> <span class="o">+</span> <span class="s2">&quot;.json&quot;</span>

    <span class="c1"># Create an instance of a Dropbox class, which can make requests to the API.</span>
    <span class="k">with</span> <span class="n">dropbox</span><span class="o">.</span><span class="n">Dropbox</span><span class="p">(</span>
        <span class="n">app_key</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">app_key</span><span class="p">,</span>
        <span class="n">app_secret</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">app_secret</span><span class="p">,</span>
        <span class="n">oauth2_refresh_token</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">refresh_token</span><span class="p">,</span>
    <span class="p">)</span> <span class="k">as</span> <span class="n">dbx</span><span class="p">:</span>
        <span class="c1"># Check that the access token is valid</span>
        <span class="n">dbx</span><span class="o">.</span><span class="n">users_get_current_account</span><span class="p">()</span>
        <span class="n">dbx</span><span class="o">.</span><span class="n">files_upload</span><span class="p">(</span>
            <span class="n">dump_str</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">),</span> <span class="n">full_path</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">WriteMode</span><span class="p">(</span><span class="s2">&quot;overwrite&quot;</span><span class="p">)</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="src.sqooler.storage_providers.DropboxProvider.upload_config" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">upload_config</span><span class="p">(</span><span class="n">config_dict</span><span class="p">,</span> <span class="n">backend_name</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>The function that uploads the spooler configuration to the storage.</p>
<p>All the configurations are stored in the Backend_files/Config folder.
For each backend there is a separate folder in which the configuration is stored as a json file.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>config_dict</code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The dictionary containing the configuration</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>backend_name</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The name of the backend</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>None</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/sqooler/storage_providers.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">upload_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">backend_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The function that uploads the spooler configuration to the storage.</span>

<span class="sd">    All the configurations are stored in the Backend_files/Config folder.</span>
<span class="sd">    For each backend there is a separate folder in which the configuration is stored as a json file.</span>

<span class="sd">    Args:</span>
<span class="sd">        config_dict: The dictionary containing the configuration</span>
<span class="sd">        backend_name (str): The name of the backend</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">config_path</span> <span class="o">=</span> <span class="s2">&quot;Backend_files/Config/&quot;</span> <span class="o">+</span> <span class="n">backend_name</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">upload</span><span class="p">(</span><span class="n">config_dict</span><span class="p">,</span> <span class="n">config_path</span><span class="p">,</span> <span class="s2">&quot;config&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">




<h2 id="src.sqooler.storage_providers.LocalProvider" class="doc doc-heading">
          <code>LocalProvider</code>


</h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="src.sqooler.storage_providers.StorageProvider" href="#src.sqooler.storage_providers.StorageProvider">StorageProvider</a></code></p>

  
      <p>Create a file storage that works on the local machine.</p>

            <details class="quote">
              <summary>Source code in <code>src/sqooler/storage_providers.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span>
<span class="normal">911</span>
<span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span>
<span class="normal">916</span>
<span class="normal">917</span>
<span class="normal">918</span>
<span class="normal">919</span>
<span class="normal">920</span>
<span class="normal">921</span>
<span class="normal">922</span>
<span class="normal">923</span>
<span class="normal">924</span>
<span class="normal">925</span>
<span class="normal">926</span>
<span class="normal">927</span>
<span class="normal">928</span>
<span class="normal">929</span>
<span class="normal">930</span>
<span class="normal">931</span>
<span class="normal">932</span>
<span class="normal">933</span>
<span class="normal">934</span>
<span class="normal">935</span>
<span class="normal">936</span>
<span class="normal">937</span>
<span class="normal">938</span>
<span class="normal">939</span>
<span class="normal">940</span>
<span class="normal">941</span>
<span class="normal">942</span>
<span class="normal">943</span>
<span class="normal">944</span>
<span class="normal">945</span>
<span class="normal">946</span>
<span class="normal">947</span>
<span class="normal">948</span>
<span class="normal">949</span>
<span class="normal">950</span>
<span class="normal">951</span>
<span class="normal">952</span>
<span class="normal">953</span>
<span class="normal">954</span>
<span class="normal">955</span>
<span class="normal">956</span>
<span class="normal">957</span>
<span class="normal">958</span>
<span class="normal">959</span>
<span class="normal">960</span>
<span class="normal">961</span>
<span class="normal">962</span>
<span class="normal">963</span>
<span class="normal">964</span>
<span class="normal">965</span>
<span class="normal">966</span>
<span class="normal">967</span>
<span class="normal">968</span>
<span class="normal">969</span>
<span class="normal">970</span>
<span class="normal">971</span>
<span class="normal">972</span>
<span class="normal">973</span>
<span class="normal">974</span>
<span class="normal">975</span>
<span class="normal">976</span>
<span class="normal">977</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">LocalProvider</span><span class="p">(</span><span class="n">StorageProvider</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a file storage that works on the local machine.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">login_dict</span><span class="p">:</span> <span class="n">LocalLoginInformation</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set up the neccessary keys and create the client through which all the connections will run.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">base_path</span> <span class="o">=</span> <span class="n">login_dict</span><span class="o">.</span><span class="n">base_path</span>

    <span class="k">def</span> <span class="nf">upload</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content_dict</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">,</span> <span class="n">storage_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">job_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Upload the file to the storage</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># strip trailing and leading slashes from the storage_path</span>
        <span class="n">storage_path</span> <span class="o">=</span> <span class="n">storage_path</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span>

        <span class="c1"># json folder</span>
        <span class="n">folder_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_path</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">storage_path</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">folder_path</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">folder_path</span><span class="p">)</span>

        <span class="c1"># create the full path</span>
        <span class="n">full_json_path</span> <span class="o">=</span> <span class="n">folder_path</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">job_id</span> <span class="o">+</span> <span class="s2">&quot;.json&quot;</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">full_json_path</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">json_file</span><span class="p">:</span>
            <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">content_dict</span><span class="p">,</span> <span class="n">json_file</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_file_content</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">storage_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">job_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the file content from the storage</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># strip trailing and leading slashes from the storage_path</span>
        <span class="n">storage_path</span> <span class="o">=</span> <span class="n">storage_path</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span>

        <span class="c1"># create the full path</span>
        <span class="n">full_json_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_path</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">storage_path</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">job_id</span> <span class="o">+</span> <span class="s2">&quot;.json&quot;</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">full_json_path</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">json_file</span><span class="p">:</span>
            <span class="n">loaded_data_dict</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">json_file</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">loaded_data_dict</span>

    <span class="k">def</span> <span class="nf">get_job_content</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">storage_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">job_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the content of the job from the storage. This is a wrapper around get_file_content</span>
<span class="sd">        and and handles the different ways of identifiying the job.</span>

<span class="sd">        storage_path: the path towards the file, excluding the filename / id</span>
<span class="sd">        job_id: the id of the file we are about to look up</span>

<span class="sd">        Returns:</span>
<span class="sd">            The content of the job</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">job_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_file_content</span><span class="p">(</span><span class="n">storage_path</span><span class="o">=</span><span class="n">storage_path</span><span class="p">,</span> <span class="n">job_id</span><span class="o">=</span><span class="n">job_id</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">job_dict</span>

    <span class="k">def</span> <span class="nf">update_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">storage_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">job_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Update the file content.</span>

<span class="sd">        Args:</span>
<span class="sd">            content_dict: The dictionary containing the new content of the file</span>
<span class="sd">            storage_path: The path to the file</span>
<span class="sd">            job_id: The id of the job</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># strip trailing and leading slashes from the storage_path</span>
        <span class="n">storage_path</span> <span class="o">=</span> <span class="n">storage_path</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span>

        <span class="c1"># json folder</span>
        <span class="n">folder_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_path</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">storage_path</span>

        <span class="c1"># create the full path</span>
        <span class="n">full_json_path</span> <span class="o">=</span> <span class="n">folder_path</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">job_id</span> <span class="o">+</span> <span class="s2">&quot;.json&quot;</span>

        <span class="c1"># does the file already exist ?</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">full_json_path</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;The file </span><span class="si">{</span><span class="n">full_json_path</span><span class="si">}</span><span class="s2"> does not exist and cannot be updated.&quot;</span>
            <span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">full_json_path</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">json_file</span><span class="p">:</span>
            <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">content_dict</span><span class="p">,</span> <span class="n">json_file</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">move_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">final_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">job_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Move the file from `start_path` to `final_path`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">start_path</span> <span class="o">=</span> <span class="n">start_path</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span>

        <span class="n">source_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_path</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">start_path</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">job_id</span> <span class="o">+</span> <span class="s2">&quot;.json&quot;</span>
        <span class="n">final_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_path</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">final_path</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">final_path</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">final_path</span><span class="p">)</span>

        <span class="c1"># Move the file</span>
        <span class="n">shutil</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="n">source_file</span><span class="p">,</span> <span class="n">final_path</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">delete_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">storage_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">job_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Delete the file from the storage</span>

<span class="sd">        Args:</span>
<span class="sd">            storage_path: the path where the file is currently stored, but excluding the file name</span>
<span class="sd">            job_id: the name of the file</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">storage_path</span> <span class="o">=</span> <span class="n">storage_path</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span>
        <span class="n">source_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_path</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">storage_path</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">job_id</span> <span class="o">+</span> <span class="s2">&quot;.json&quot;</span>
        <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">source_file</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">upload_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">backend_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The function that uploads the spooler configuration to the storage.</span>

<span class="sd">        Args:</span>
<span class="sd">            config_dict: The dictionary containing the configuration</span>
<span class="sd">            backend_name (str): The name of the backend</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># path of the configs</span>
        <span class="n">config_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_path</span> <span class="o">+</span> <span class="s2">&quot;/backends/configs&quot;</span>
        <span class="c1"># test if the config path already exists. If it does not, create it</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">config_path</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">config_path</span><span class="p">)</span>

        <span class="n">full_json_path</span> <span class="o">=</span> <span class="n">config_path</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">backend_name</span> <span class="o">+</span> <span class="s2">&quot;.json&quot;</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">full_json_path</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">json_file</span><span class="p">:</span>
            <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">config_dict</span><span class="p">,</span> <span class="n">json_file</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">update_in_database</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">result_dict</span><span class="p">:</span> <span class="n">ResultDict</span><span class="p">,</span>
        <span class="n">status_msg_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
        <span class="n">job_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">backend_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Upload the status and result to the `StorageProvider`.</span>

<span class="sd">        Args:</span>
<span class="sd">            result_dict: the dictionary containing the result of the job</span>
<span class="sd">            status_msg_dict: the dictionary containing the status message of the job</span>
<span class="sd">            job_id: the name of the job</span>
<span class="sd">            backend_name: the name of the backend</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">job_json_start_dir</span> <span class="o">=</span> <span class="s2">&quot;jobs/running&quot;</span>
        <span class="c1"># check if the job is done or had an error</span>
        <span class="k">if</span> <span class="n">status_msg_dict</span><span class="p">[</span><span class="s2">&quot;status&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;DONE&quot;</span><span class="p">:</span>
            <span class="c1"># test if the result dict is None</span>
            <span class="k">if</span> <span class="n">result_dict</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;The &#39;result_dict&#39; argument cannot be None if the job is done.&quot;</span>
                <span class="p">)</span>
            <span class="c1"># let us create the result json file</span>
            <span class="n">result_json_dir</span> <span class="o">=</span> <span class="s2">&quot;results/&quot;</span> <span class="o">+</span> <span class="n">backend_name</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">upload</span><span class="p">(</span><span class="n">result_dict</span><span class="p">,</span> <span class="n">result_json_dir</span><span class="p">,</span> <span class="n">job_id</span><span class="p">)</span>

            <span class="c1"># now move the job out of the running jobs into the finished jobs</span>
            <span class="n">job_finished_json_dir</span> <span class="o">=</span> <span class="s2">&quot;jobs/finished/&quot;</span> <span class="o">+</span> <span class="n">backend_name</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">move_file</span><span class="p">(</span><span class="n">job_json_start_dir</span><span class="p">,</span> <span class="n">job_finished_json_dir</span><span class="p">,</span> <span class="n">job_id</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">status_msg_dict</span><span class="p">[</span><span class="s2">&quot;status&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;ERROR&quot;</span><span class="p">:</span>
            <span class="c1"># because there was an error, we move the job to the deleted jobs</span>
            <span class="n">deleted_json_dir</span> <span class="o">=</span> <span class="s2">&quot;jobs/deleted&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">move_file</span><span class="p">(</span><span class="n">job_json_start_dir</span><span class="p">,</span> <span class="n">deleted_json_dir</span><span class="p">,</span> <span class="n">job_id</span><span class="p">)</span>

        <span class="c1"># and create the status json file</span>
        <span class="n">status_json_dir</span> <span class="o">=</span> <span class="s2">&quot;status/&quot;</span> <span class="o">+</span> <span class="n">backend_name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_file</span><span class="p">(</span><span class="n">status_msg_dict</span><span class="p">,</span> <span class="n">status_json_dir</span><span class="p">,</span> <span class="n">job_id</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_file_queue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">storage_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get a list of files</span>

<span class="sd">        Args:</span>
<span class="sd">            storage_path: Where are we looking for the files.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A list of files that was found.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># get a list of files in the folder</span>
        <span class="n">full_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_path</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">storage_path</span>
        <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">full_path</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_next_job_in_queue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">backend_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A function that obtains the next job in the queue.</span>

<span class="sd">        Args:</span>
<span class="sd">            backend_name: The name of the backend</span>

<span class="sd">        Returns:</span>
<span class="sd">            the path towards the job</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">queue_dir</span> <span class="o">=</span> <span class="s2">&quot;jobs/queued/&quot;</span> <span class="o">+</span> <span class="n">backend_name</span>
        <span class="n">job_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;job_id&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;job_json_path&quot;</span><span class="p">:</span> <span class="s2">&quot;None&quot;</span><span class="p">}</span>
        <span class="n">job_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_file_queue</span><span class="p">(</span><span class="n">queue_dir</span><span class="p">)</span>
        <span class="c1"># if there is a job, we should move it</span>
        <span class="k">if</span> <span class="n">job_list</span><span class="p">:</span>
            <span class="n">job_json_name</span> <span class="o">=</span> <span class="n">job_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">job_id</span> <span class="o">=</span> <span class="n">job_json_name</span><span class="p">[:</span><span class="o">-</span><span class="mi">5</span><span class="p">]</span>
            <span class="n">job_dict</span><span class="p">[</span><span class="s2">&quot;job_id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">job_id</span>

            <span class="c1"># and move the file into the right directory</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">move_file</span><span class="p">(</span><span class="n">queue_dir</span><span class="p">,</span> <span class="s2">&quot;jobs/running&quot;</span><span class="p">,</span> <span class="n">job_id</span><span class="p">)</span>
            <span class="n">job_dict</span><span class="p">[</span><span class="s2">&quot;job_json_path&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;jobs/running&quot;</span>
        <span class="k">return</span> <span class="n">job_dict</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h3 id="src.sqooler.storage_providers.LocalProvider.__init__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">login_dict</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Set up the neccessary keys and create the client through which all the connections will run.</p>

          <details class="quote">
            <summary>Source code in <code>src/sqooler/storage_providers.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">login_dict</span><span class="p">:</span> <span class="n">LocalLoginInformation</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Set up the neccessary keys and create the client through which all the connections will run.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">base_path</span> <span class="o">=</span> <span class="n">login_dict</span><span class="o">.</span><span class="n">base_path</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="src.sqooler.storage_providers.LocalProvider.delete_file" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">delete_file</span><span class="p">(</span><span class="n">storage_path</span><span class="p">,</span> <span class="n">job_id</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Delete the file from the storage</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>storage_path</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the path where the file is currently stored, but excluding the file name</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>job_id</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the name of the file</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>None</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/sqooler/storage_providers.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">delete_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">storage_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">job_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Delete the file from the storage</span>

<span class="sd">    Args:</span>
<span class="sd">        storage_path: the path where the file is currently stored, but excluding the file name</span>
<span class="sd">        job_id: the name of the file</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">storage_path</span> <span class="o">=</span> <span class="n">storage_path</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span>
    <span class="n">source_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_path</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">storage_path</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">job_id</span> <span class="o">+</span> <span class="s2">&quot;.json&quot;</span>
    <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">source_file</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="src.sqooler.storage_providers.LocalProvider.get_file_content" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_file_content</span><span class="p">(</span><span class="n">storage_path</span><span class="p">,</span> <span class="n">job_id</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Get the file content from the storage</p>

          <details class="quote">
            <summary>Source code in <code>src/sqooler/storage_providers.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_file_content</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">storage_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">job_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the file content from the storage</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># strip trailing and leading slashes from the storage_path</span>
    <span class="n">storage_path</span> <span class="o">=</span> <span class="n">storage_path</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span>

    <span class="c1"># create the full path</span>
    <span class="n">full_json_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_path</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">storage_path</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">job_id</span> <span class="o">+</span> <span class="s2">&quot;.json&quot;</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">full_json_path</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">json_file</span><span class="p">:</span>
        <span class="n">loaded_data_dict</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">json_file</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">loaded_data_dict</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="src.sqooler.storage_providers.LocalProvider.get_file_queue" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_file_queue</span><span class="p">(</span><span class="n">storage_path</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Get a list of files</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>storage_path</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Where are we looking for the files.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>list[str]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A list of files that was found.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/sqooler/storage_providers.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">941</span>
<span class="normal">942</span>
<span class="normal">943</span>
<span class="normal">944</span>
<span class="normal">945</span>
<span class="normal">946</span>
<span class="normal">947</span>
<span class="normal">948</span>
<span class="normal">949</span>
<span class="normal">950</span>
<span class="normal">951</span>
<span class="normal">952</span>
<span class="normal">953</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_file_queue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">storage_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get a list of files</span>

<span class="sd">    Args:</span>
<span class="sd">        storage_path: Where are we looking for the files.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A list of files that was found.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># get a list of files in the folder</span>
    <span class="n">full_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_path</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">storage_path</span>
    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">full_path</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="src.sqooler.storage_providers.LocalProvider.get_job_content" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_job_content</span><span class="p">(</span><span class="n">storage_path</span><span class="p">,</span> <span class="n">job_id</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Get the content of the job from the storage. This is a wrapper around get_file_content
and and handles the different ways of identifiying the job.</p>
<p>storage_path: the path towards the file, excluding the filename / id
job_id: the id of the file we are about to look up</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The content of the job</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/sqooler/storage_providers.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_job_content</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">storage_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">job_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the content of the job from the storage. This is a wrapper around get_file_content</span>
<span class="sd">    and and handles the different ways of identifiying the job.</span>

<span class="sd">    storage_path: the path towards the file, excluding the filename / id</span>
<span class="sd">    job_id: the id of the file we are about to look up</span>

<span class="sd">    Returns:</span>
<span class="sd">        The content of the job</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">job_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_file_content</span><span class="p">(</span><span class="n">storage_path</span><span class="o">=</span><span class="n">storage_path</span><span class="p">,</span> <span class="n">job_id</span><span class="o">=</span><span class="n">job_id</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">job_dict</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="src.sqooler.storage_providers.LocalProvider.get_next_job_in_queue" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_next_job_in_queue</span><span class="p">(</span><span class="n">backend_name</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>A function that obtains the next job in the queue.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>backend_name</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The name of the backend</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the path towards the job</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/sqooler/storage_providers.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">955</span>
<span class="normal">956</span>
<span class="normal">957</span>
<span class="normal">958</span>
<span class="normal">959</span>
<span class="normal">960</span>
<span class="normal">961</span>
<span class="normal">962</span>
<span class="normal">963</span>
<span class="normal">964</span>
<span class="normal">965</span>
<span class="normal">966</span>
<span class="normal">967</span>
<span class="normal">968</span>
<span class="normal">969</span>
<span class="normal">970</span>
<span class="normal">971</span>
<span class="normal">972</span>
<span class="normal">973</span>
<span class="normal">974</span>
<span class="normal">975</span>
<span class="normal">976</span>
<span class="normal">977</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_next_job_in_queue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">backend_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A function that obtains the next job in the queue.</span>

<span class="sd">    Args:</span>
<span class="sd">        backend_name: The name of the backend</span>

<span class="sd">    Returns:</span>
<span class="sd">        the path towards the job</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">queue_dir</span> <span class="o">=</span> <span class="s2">&quot;jobs/queued/&quot;</span> <span class="o">+</span> <span class="n">backend_name</span>
    <span class="n">job_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;job_id&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;job_json_path&quot;</span><span class="p">:</span> <span class="s2">&quot;None&quot;</span><span class="p">}</span>
    <span class="n">job_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_file_queue</span><span class="p">(</span><span class="n">queue_dir</span><span class="p">)</span>
    <span class="c1"># if there is a job, we should move it</span>
    <span class="k">if</span> <span class="n">job_list</span><span class="p">:</span>
        <span class="n">job_json_name</span> <span class="o">=</span> <span class="n">job_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">job_id</span> <span class="o">=</span> <span class="n">job_json_name</span><span class="p">[:</span><span class="o">-</span><span class="mi">5</span><span class="p">]</span>
        <span class="n">job_dict</span><span class="p">[</span><span class="s2">&quot;job_id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">job_id</span>

        <span class="c1"># and move the file into the right directory</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">move_file</span><span class="p">(</span><span class="n">queue_dir</span><span class="p">,</span> <span class="s2">&quot;jobs/running&quot;</span><span class="p">,</span> <span class="n">job_id</span><span class="p">)</span>
        <span class="n">job_dict</span><span class="p">[</span><span class="s2">&quot;job_json_path&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;jobs/running&quot;</span>
    <span class="k">return</span> <span class="n">job_dict</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="src.sqooler.storage_providers.LocalProvider.move_file" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">move_file</span><span class="p">(</span><span class="n">start_path</span><span class="p">,</span> <span class="n">final_path</span><span class="p">,</span> <span class="n">job_id</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Move the file from <code>start_path</code> to <code>final_path</code></p>

          <details class="quote">
            <summary>Source code in <code>src/sqooler/storage_providers.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">move_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">final_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">job_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Move the file from `start_path` to `final_path`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">start_path</span> <span class="o">=</span> <span class="n">start_path</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span>

    <span class="n">source_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_path</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">start_path</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">job_id</span> <span class="o">+</span> <span class="s2">&quot;.json&quot;</span>
    <span class="n">final_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_path</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">final_path</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">final_path</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">final_path</span><span class="p">)</span>

    <span class="c1"># Move the file</span>
    <span class="n">shutil</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="n">source_file</span><span class="p">,</span> <span class="n">final_path</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="src.sqooler.storage_providers.LocalProvider.update_file" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">update_file</span><span class="p">(</span><span class="n">content_dict</span><span class="p">,</span> <span class="n">storage_path</span><span class="p">,</span> <span class="n">job_id</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Update the file content.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>content_dict</code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The dictionary containing the new content of the file</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>storage_path</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The path to the file</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>job_id</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The id of the job</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>None</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/sqooler/storage_providers.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">update_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">storage_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">job_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Update the file content.</span>

<span class="sd">    Args:</span>
<span class="sd">        content_dict: The dictionary containing the new content of the file</span>
<span class="sd">        storage_path: The path to the file</span>
<span class="sd">        job_id: The id of the job</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># strip trailing and leading slashes from the storage_path</span>
    <span class="n">storage_path</span> <span class="o">=</span> <span class="n">storage_path</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span>

    <span class="c1"># json folder</span>
    <span class="n">folder_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_path</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">storage_path</span>

    <span class="c1"># create the full path</span>
    <span class="n">full_json_path</span> <span class="o">=</span> <span class="n">folder_path</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">job_id</span> <span class="o">+</span> <span class="s2">&quot;.json&quot;</span>

    <span class="c1"># does the file already exist ?</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">full_json_path</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;The file </span><span class="si">{</span><span class="n">full_json_path</span><span class="si">}</span><span class="s2"> does not exist and cannot be updated.&quot;</span>
        <span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">full_json_path</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">json_file</span><span class="p">:</span>
        <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">content_dict</span><span class="p">,</span> <span class="n">json_file</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="src.sqooler.storage_providers.LocalProvider.update_in_database" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">update_in_database</span><span class="p">(</span><span class="n">result_dict</span><span class="p">,</span> <span class="n">status_msg_dict</span><span class="p">,</span> <span class="n">job_id</span><span class="p">,</span> <span class="n">backend_name</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Upload the status and result to the <code>StorageProvider</code>.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>result_dict</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="src.sqooler.schemes.ResultDict" href="#src.sqooler.schemes.ResultDict">ResultDict</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the dictionary containing the result of the job</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>status_msg_dict</code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the dictionary containing the status message of the job</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>job_id</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the name of the job</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>backend_name</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the name of the backend</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>None</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/sqooler/storage_providers.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span>
<span class="normal">911</span>
<span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span>
<span class="normal">916</span>
<span class="normal">917</span>
<span class="normal">918</span>
<span class="normal">919</span>
<span class="normal">920</span>
<span class="normal">921</span>
<span class="normal">922</span>
<span class="normal">923</span>
<span class="normal">924</span>
<span class="normal">925</span>
<span class="normal">926</span>
<span class="normal">927</span>
<span class="normal">928</span>
<span class="normal">929</span>
<span class="normal">930</span>
<span class="normal">931</span>
<span class="normal">932</span>
<span class="normal">933</span>
<span class="normal">934</span>
<span class="normal">935</span>
<span class="normal">936</span>
<span class="normal">937</span>
<span class="normal">938</span>
<span class="normal">939</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">update_in_database</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">result_dict</span><span class="p">:</span> <span class="n">ResultDict</span><span class="p">,</span>
    <span class="n">status_msg_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
    <span class="n">job_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">backend_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Upload the status and result to the `StorageProvider`.</span>

<span class="sd">    Args:</span>
<span class="sd">        result_dict: the dictionary containing the result of the job</span>
<span class="sd">        status_msg_dict: the dictionary containing the status message of the job</span>
<span class="sd">        job_id: the name of the job</span>
<span class="sd">        backend_name: the name of the backend</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">job_json_start_dir</span> <span class="o">=</span> <span class="s2">&quot;jobs/running&quot;</span>
    <span class="c1"># check if the job is done or had an error</span>
    <span class="k">if</span> <span class="n">status_msg_dict</span><span class="p">[</span><span class="s2">&quot;status&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;DONE&quot;</span><span class="p">:</span>
        <span class="c1"># test if the result dict is None</span>
        <span class="k">if</span> <span class="n">result_dict</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;The &#39;result_dict&#39; argument cannot be None if the job is done.&quot;</span>
            <span class="p">)</span>
        <span class="c1"># let us create the result json file</span>
        <span class="n">result_json_dir</span> <span class="o">=</span> <span class="s2">&quot;results/&quot;</span> <span class="o">+</span> <span class="n">backend_name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">upload</span><span class="p">(</span><span class="n">result_dict</span><span class="p">,</span> <span class="n">result_json_dir</span><span class="p">,</span> <span class="n">job_id</span><span class="p">)</span>

        <span class="c1"># now move the job out of the running jobs into the finished jobs</span>
        <span class="n">job_finished_json_dir</span> <span class="o">=</span> <span class="s2">&quot;jobs/finished/&quot;</span> <span class="o">+</span> <span class="n">backend_name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">move_file</span><span class="p">(</span><span class="n">job_json_start_dir</span><span class="p">,</span> <span class="n">job_finished_json_dir</span><span class="p">,</span> <span class="n">job_id</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">status_msg_dict</span><span class="p">[</span><span class="s2">&quot;status&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;ERROR&quot;</span><span class="p">:</span>
        <span class="c1"># because there was an error, we move the job to the deleted jobs</span>
        <span class="n">deleted_json_dir</span> <span class="o">=</span> <span class="s2">&quot;jobs/deleted&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">move_file</span><span class="p">(</span><span class="n">job_json_start_dir</span><span class="p">,</span> <span class="n">deleted_json_dir</span><span class="p">,</span> <span class="n">job_id</span><span class="p">)</span>

    <span class="c1"># and create the status json file</span>
    <span class="n">status_json_dir</span> <span class="o">=</span> <span class="s2">&quot;status/&quot;</span> <span class="o">+</span> <span class="n">backend_name</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">update_file</span><span class="p">(</span><span class="n">status_msg_dict</span><span class="p">,</span> <span class="n">status_json_dir</span><span class="p">,</span> <span class="n">job_id</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="src.sqooler.storage_providers.LocalProvider.upload" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">upload</span><span class="p">(</span><span class="n">content_dict</span><span class="p">,</span> <span class="n">storage_path</span><span class="p">,</span> <span class="n">job_id</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Upload the file to the storage</p>

          <details class="quote">
            <summary>Source code in <code>src/sqooler/storage_providers.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">upload</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content_dict</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">,</span> <span class="n">storage_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">job_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Upload the file to the storage</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># strip trailing and leading slashes from the storage_path</span>
    <span class="n">storage_path</span> <span class="o">=</span> <span class="n">storage_path</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span>

    <span class="c1"># json folder</span>
    <span class="n">folder_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_path</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">storage_path</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">folder_path</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">folder_path</span><span class="p">)</span>

    <span class="c1"># create the full path</span>
    <span class="n">full_json_path</span> <span class="o">=</span> <span class="n">folder_path</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">job_id</span> <span class="o">+</span> <span class="s2">&quot;.json&quot;</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">full_json_path</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">json_file</span><span class="p">:</span>
        <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">content_dict</span><span class="p">,</span> <span class="n">json_file</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="src.sqooler.storage_providers.LocalProvider.upload_config" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">upload_config</span><span class="p">(</span><span class="n">config_dict</span><span class="p">,</span> <span class="n">backend_name</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>The function that uploads the spooler configuration to the storage.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>config_dict</code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The dictionary containing the configuration</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>backend_name</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The name of the backend</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>None</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/sqooler/storage_providers.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">upload_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">backend_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The function that uploads the spooler configuration to the storage.</span>

<span class="sd">    Args:</span>
<span class="sd">        config_dict: The dictionary containing the configuration</span>
<span class="sd">        backend_name (str): The name of the backend</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># path of the configs</span>
    <span class="n">config_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_path</span> <span class="o">+</span> <span class="s2">&quot;/backends/configs&quot;</span>
    <span class="c1"># test if the config path already exists. If it does not, create it</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">config_path</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">config_path</span><span class="p">)</span>

    <span class="n">full_json_path</span> <span class="o">=</span> <span class="n">config_path</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">backend_name</span> <span class="o">+</span> <span class="s2">&quot;.json&quot;</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">full_json_path</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">json_file</span><span class="p">:</span>
        <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">config_dict</span><span class="p">,</span> <span class="n">json_file</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">




<h2 id="src.sqooler.storage_providers.MongodbProvider" class="doc doc-heading">
          <code>MongodbProvider</code>


</h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="src.sqooler.storage_providers.StorageProvider" href="#src.sqooler.storage_providers.StorageProvider">StorageProvider</a></code></p>

  
      <p>The access to the mongodb</p>

            <details class="quote">
              <summary>Source code in <code>src/sqooler/storage_providers.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">MongodbProvider</span><span class="p">(</span><span class="n">StorageProvider</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The access to the mongodb</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">login_dict</span><span class="p">:</span> <span class="n">MongodbLoginInformation</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set up the neccessary keys and create the client through which all the connections will run.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">mongodb_username</span> <span class="o">=</span> <span class="n">login_dict</span><span class="o">.</span><span class="n">mongodb_username</span>
        <span class="n">mongodb_password</span> <span class="o">=</span> <span class="n">login_dict</span><span class="o">.</span><span class="n">mongodb_password</span>
        <span class="n">mongodb_database_url</span> <span class="o">=</span> <span class="n">login_dict</span><span class="o">.</span><span class="n">mongodb_database_url</span>

        <span class="n">uri</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;mongodb+srv://</span><span class="si">{</span><span class="n">mongodb_username</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">mongodb_password</span><span class="si">}</span><span class="s2">@</span><span class="si">{</span><span class="n">mongodb_database_url</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">uri</span> <span class="o">=</span> <span class="n">uri</span> <span class="o">+</span> <span class="s2">&quot;/?retryWrites=true&amp;w=majority&quot;</span>
        <span class="c1"># Create a new client and connect to the server</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="p">:</span> <span class="n">MongoClient</span> <span class="o">=</span> <span class="n">MongoClient</span><span class="p">(</span><span class="n">uri</span><span class="p">)</span>

        <span class="c1"># Send a ping to confirm a successful connection</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">admin</span><span class="o">.</span><span class="n">command</span><span class="p">(</span><span class="s2">&quot;ping&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">upload</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content_dict</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">,</span> <span class="n">storage_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">job_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Upload the file to the storage</span>

<span class="sd">        content_dict: the content that should be uploaded onto the mongodb base</span>
<span class="sd">        storage_path: the access path towards the mongodb collection</span>
<span class="sd">        job_id: the id of the file we are about to create</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">storage_splitted</span> <span class="o">=</span> <span class="n">storage_path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span>

        <span class="c1"># get the database on which we work</span>
        <span class="n">database</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="p">[</span><span class="n">storage_splitted</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>

        <span class="c1"># get the collection on which we work</span>
        <span class="n">collection_name</span> <span class="o">=</span> <span class="s2">&quot;.&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">storage_splitted</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
        <span class="n">collection</span> <span class="o">=</span> <span class="n">database</span><span class="p">[</span><span class="n">collection_name</span><span class="p">]</span>

        <span class="n">content_dict</span><span class="p">[</span><span class="s2">&quot;_id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ObjectId</span><span class="p">(</span><span class="n">job_id</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
        <span class="n">collection</span><span class="o">.</span><span class="n">insert_one</span><span class="p">(</span><span class="n">content_dict</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_file_content</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">storage_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">job_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the file content from the storage</span>

<span class="sd">        storage_path: the path towards the file, excluding the filename / id</span>
<span class="sd">        job_id: the id of the file we are about to look up</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">document_to_find</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;_id&quot;</span><span class="p">:</span> <span class="n">ObjectId</span><span class="p">(</span><span class="n">job_id</span><span class="p">)}</span>

        <span class="c1"># get the database on which we work</span>
        <span class="n">database</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="p">[</span><span class="n">storage_path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]]</span>

        <span class="c1"># get the collection on which we work</span>
        <span class="n">collection_name</span> <span class="o">=</span> <span class="s2">&quot;.&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">storage_path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">:])</span>
        <span class="n">collection</span> <span class="o">=</span> <span class="n">database</span><span class="p">[</span><span class="n">collection_name</span><span class="p">]</span>

        <span class="n">result_found</span> <span class="o">=</span> <span class="n">collection</span><span class="o">.</span><span class="n">find_one</span><span class="p">(</span><span class="n">document_to_find</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">result_found</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">{}</span>
        <span class="k">return</span> <span class="n">result_found</span>

    <span class="k">def</span> <span class="nf">get_job_content</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">storage_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">job_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the content of the job from the storage. This is a wrapper around get_file_content</span>
<span class="sd">        and and handles the different ways of identifiying the job.</span>

<span class="sd">        storage_path: the path towards the file, excluding the filename / id</span>
<span class="sd">        job_id: the id of the file we are about to look up</span>

<span class="sd">        Returns:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">job_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_file_content</span><span class="p">(</span><span class="n">storage_path</span><span class="o">=</span><span class="n">storage_path</span><span class="p">,</span> <span class="n">job_id</span><span class="o">=</span><span class="n">job_id</span><span class="p">)</span>
        <span class="n">job_dict</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;_id&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">job_dict</span>

    <span class="k">def</span> <span class="nf">update_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">storage_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">job_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Update the file content.</span>

<span class="sd">        Args:</span>
<span class="sd">            content_dict: The dictionary containing the new content of the file</span>
<span class="sd">            storage_path: The path to the file</span>
<span class="sd">            job_id: The id of the job</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># get the database on which we work</span>
        <span class="n">database</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="p">[</span><span class="n">storage_path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]]</span>

        <span class="c1"># get the collection on which we work</span>
        <span class="n">collection_name</span> <span class="o">=</span> <span class="s2">&quot;.&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">storage_path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">:])</span>
        <span class="n">collection</span> <span class="o">=</span> <span class="n">database</span><span class="p">[</span><span class="n">collection_name</span><span class="p">]</span>

        <span class="n">filter_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;_id&quot;</span><span class="p">:</span> <span class="n">ObjectId</span><span class="p">(</span><span class="n">job_id</span><span class="p">)}</span>

        <span class="n">newvalues</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;$set&quot;</span><span class="p">:</span> <span class="n">content_dict</span><span class="p">}</span>
        <span class="n">collection</span><span class="o">.</span><span class="n">update_one</span><span class="p">(</span><span class="n">filter_dict</span><span class="p">,</span> <span class="n">newvalues</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">move_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">final_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">job_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Move the file from start_path to final_path</span>

<span class="sd">        start_path: the path where the file is currently stored, but excluding the file name</span>
<span class="sd">        final_path: the path where the file should be stored, but excluding the file name</span>
<span class="sd">        job_id: the name of the file. Is a json file</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># get the database on which we work</span>
        <span class="n">database</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="p">[</span><span class="n">start_path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]]</span>

        <span class="c1"># get the collection on which we work</span>
        <span class="n">collection_name</span> <span class="o">=</span> <span class="s2">&quot;.&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">start_path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">:])</span>
        <span class="n">collection</span> <span class="o">=</span> <span class="n">database</span><span class="p">[</span><span class="n">collection_name</span><span class="p">]</span>

        <span class="n">document_to_find</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;_id&quot;</span><span class="p">:</span> <span class="n">ObjectId</span><span class="p">(</span><span class="n">job_id</span><span class="p">)}</span>
        <span class="n">result_found</span> <span class="o">=</span> <span class="n">collection</span><span class="o">.</span><span class="n">find_one</span><span class="p">(</span><span class="n">document_to_find</span><span class="p">)</span>

        <span class="c1"># delete the old file</span>
        <span class="n">collection</span><span class="o">.</span><span class="n">delete_one</span><span class="p">(</span><span class="n">document_to_find</span><span class="p">)</span>

        <span class="c1"># add the document to the new collection</span>
        <span class="n">database</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="p">[</span><span class="n">final_path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]]</span>
        <span class="n">collection_name</span> <span class="o">=</span> <span class="s2">&quot;.&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">final_path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">:])</span>
        <span class="n">collection</span> <span class="o">=</span> <span class="n">database</span><span class="p">[</span><span class="n">collection_name</span><span class="p">]</span>
        <span class="n">collection</span><span class="o">.</span><span class="n">insert_one</span><span class="p">(</span><span class="n">result_found</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">delete_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">storage_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">job_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Remove the file from the mongodb database</span>

<span class="sd">        Args:</span>
<span class="sd">            storage_path: the path where the file is currently stored, but excluding the file name</span>
<span class="sd">            job_id: the name of the file</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># get the database on which we work</span>
        <span class="n">database</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="p">[</span><span class="n">storage_path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]]</span>

        <span class="c1"># get the collection on which we work</span>
        <span class="n">collection_name</span> <span class="o">=</span> <span class="s2">&quot;.&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">storage_path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">:])</span>
        <span class="n">collection</span> <span class="o">=</span> <span class="n">database</span><span class="p">[</span><span class="n">collection_name</span><span class="p">]</span>

        <span class="n">document_to_find</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;_id&quot;</span><span class="p">:</span> <span class="n">ObjectId</span><span class="p">(</span><span class="n">job_id</span><span class="p">)}</span>
        <span class="n">collection</span><span class="o">.</span><span class="n">delete_one</span><span class="p">(</span><span class="n">document_to_find</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">upload_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">backend_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The function that uploads the spooler configuration to the storage.</span>

<span class="sd">        Args:</span>
<span class="sd">            config_dict: The dictionary containing the configuration</span>
<span class="sd">            backend_name (str): The name of the backend</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">config_path</span> <span class="o">=</span> <span class="s2">&quot;backends/configs&quot;</span>

        <span class="c1"># first we have to check if the device already exists in the database</span>

        <span class="n">document_to_find</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;display_name&quot;</span><span class="p">:</span> <span class="n">backend_name</span><span class="p">}</span>

        <span class="c1"># get the database on which we work</span>
        <span class="n">database</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="p">[</span><span class="s2">&quot;backends&quot;</span><span class="p">]</span>

        <span class="c1"># get the collection on which we work</span>
        <span class="n">collection</span> <span class="o">=</span> <span class="n">database</span><span class="p">[</span><span class="s2">&quot;configs&quot;</span><span class="p">]</span>

        <span class="n">result_found</span> <span class="o">=</span> <span class="n">collection</span><span class="o">.</span><span class="n">find_one</span><span class="p">(</span><span class="n">document_to_find</span><span class="p">)</span>
        <span class="n">config_dict</span><span class="p">[</span><span class="s2">&quot;display_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">backend_name</span>
        <span class="k">if</span> <span class="n">result_found</span><span class="p">:</span>
            <span class="c1"># update the file</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_file</span><span class="p">(</span>
                <span class="n">content_dict</span><span class="o">=</span><span class="n">config_dict</span><span class="p">,</span>
                <span class="n">storage_path</span><span class="o">=</span><span class="n">config_path</span><span class="p">,</span>
                <span class="n">job_id</span><span class="o">=</span><span class="n">result_found</span><span class="p">[</span><span class="s2">&quot;_id&quot;</span><span class="p">],</span>
            <span class="p">)</span>
            <span class="k">return</span>

        <span class="c1"># if the device does not exist, we have to create it</span>

        <span class="n">config_id</span> <span class="o">=</span> <span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()</span><span class="o">.</span><span class="n">hex</span><span class="p">[:</span><span class="mi">24</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">upload</span><span class="p">(</span><span class="n">config_dict</span><span class="p">,</span> <span class="n">config_path</span><span class="p">,</span> <span class="n">config_id</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">update_in_database</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">result_dict</span><span class="p">:</span> <span class="n">ResultDict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">status_msg_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
        <span class="n">job_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">backend_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Upload the status and result to the `StorageProvider`.</span>

<span class="sd">        The function checks if the reported status of the job has changed to DONE. If so, it will create</span>
<span class="sd">        a result json file and move the job json file to the finished folder. It will also update the</span>
<span class="sd">        status json file.</span>

<span class="sd">        Args:</span>
<span class="sd">            result_dict: the dictionary containing the result of the job</span>
<span class="sd">            status_msg_dict: the dictionary containing the status message of the job</span>
<span class="sd">            job_id: the name of the job</span>
<span class="sd">            backend_name: the name of the backend</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>

<span class="sd">        Raises:</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">job_json_start_dir</span> <span class="o">=</span> <span class="s2">&quot;jobs/running&quot;</span>
        <span class="c1"># check if the job is done or had an error</span>
        <span class="k">if</span> <span class="n">status_msg_dict</span><span class="p">[</span><span class="s2">&quot;status&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;DONE&quot;</span><span class="p">:</span>
            <span class="c1"># test if the result dict is None</span>
            <span class="k">if</span> <span class="n">result_dict</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;The &#39;result_dict&#39; argument cannot be None if the job is done.&quot;</span>
                <span class="p">)</span>
            <span class="c1"># let us create the result json file</span>
            <span class="n">result_json_dir</span> <span class="o">=</span> <span class="s2">&quot;results/&quot;</span> <span class="o">+</span> <span class="n">backend_name</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">upload</span><span class="p">(</span><span class="n">result_dict</span><span class="p">,</span> <span class="n">result_json_dir</span><span class="p">,</span> <span class="n">job_id</span><span class="p">)</span>

            <span class="c1"># now move the job out of the running jobs into the finished jobs</span>
            <span class="n">job_finished_json_dir</span> <span class="o">=</span> <span class="s2">&quot;jobs/finished/&quot;</span> <span class="o">+</span> <span class="n">backend_name</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">move_file</span><span class="p">(</span><span class="n">job_json_start_dir</span><span class="p">,</span> <span class="n">job_finished_json_dir</span><span class="p">,</span> <span class="n">job_id</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">status_msg_dict</span><span class="p">[</span><span class="s2">&quot;status&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;ERROR&quot;</span><span class="p">:</span>
            <span class="c1"># because there was an error, we move the job to the deleted jobs</span>
            <span class="n">deleted_json_dir</span> <span class="o">=</span> <span class="s2">&quot;jobs/deleted&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">move_file</span><span class="p">(</span><span class="n">job_json_start_dir</span><span class="p">,</span> <span class="n">deleted_json_dir</span><span class="p">,</span> <span class="n">job_id</span><span class="p">)</span>

        <span class="c1"># TODO: most likely we should raise an error if the status of the job is not DONE or ERROR</span>

        <span class="c1"># and create the status json file</span>
        <span class="n">status_json_dir</span> <span class="o">=</span> <span class="s2">&quot;status/&quot;</span> <span class="o">+</span> <span class="n">backend_name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_file</span><span class="p">(</span><span class="n">status_msg_dict</span><span class="p">,</span> <span class="n">status_json_dir</span><span class="p">,</span> <span class="n">job_id</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_file_queue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">storage_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get a list of documents in the collection of all the queued jobs.</span>

<span class="sd">        Args:</span>
<span class="sd">            storage_path: Where are we looking for the files.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A list of files that was found.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># strip trailing and leading slashes from the paths</span>
        <span class="n">storage_path</span> <span class="o">=</span> <span class="n">storage_path</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span>

        <span class="c1"># get the database on which we work</span>
        <span class="n">database</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="p">[</span><span class="n">storage_path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]]</span>

        <span class="c1"># get the collection on which we work</span>
        <span class="n">collection_name</span> <span class="o">=</span> <span class="s2">&quot;.&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">storage_path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">:])</span>
        <span class="n">collection</span> <span class="o">=</span> <span class="n">database</span><span class="p">[</span><span class="n">collection_name</span><span class="p">]</span>

        <span class="c1"># now get the id of all the documents in the collection</span>
        <span class="n">results</span> <span class="o">=</span> <span class="n">collection</span><span class="o">.</span><span class="n">find</span><span class="p">({},</span> <span class="p">{</span><span class="s2">&quot;_id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
        <span class="n">file_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
            <span class="n">file_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="s2">&quot;_id&quot;</span><span class="p">]))</span>
        <span class="k">return</span> <span class="n">file_list</span>

    <span class="k">def</span> <span class="nf">get_next_job_in_queue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">backend_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A function that obtains the next job in the queue. It looks in the queued folder and moves the</span>
<span class="sd">        first job to the running folder.</span>

<span class="sd">        Args:</span>
<span class="sd">            backend_name (str): The name of the backend</span>

<span class="sd">        Returns:</span>
<span class="sd">            the path towards the job</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">queue_dir</span> <span class="o">=</span> <span class="s2">&quot;jobs/queued/&quot;</span> <span class="o">+</span> <span class="n">backend_name</span>
        <span class="n">job_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;job_id&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;job_json_path&quot;</span><span class="p">:</span> <span class="s2">&quot;None&quot;</span><span class="p">}</span>
        <span class="n">job_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_file_queue</span><span class="p">(</span><span class="n">queue_dir</span><span class="p">)</span>
        <span class="c1"># if there is a job, we should move it</span>
        <span class="k">if</span> <span class="n">job_list</span><span class="p">:</span>
            <span class="n">job_id</span> <span class="o">=</span> <span class="n">job_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">job_dict</span><span class="p">[</span><span class="s2">&quot;job_id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">job_id</span>

            <span class="c1"># and move the file into the right directory</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">move_file</span><span class="p">(</span><span class="n">queue_dir</span><span class="p">,</span> <span class="s2">&quot;jobs/running&quot;</span><span class="p">,</span> <span class="n">job_id</span><span class="p">)</span>
            <span class="n">job_dict</span><span class="p">[</span><span class="s2">&quot;job_json_path&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;jobs/running&quot;</span>
        <span class="k">return</span> <span class="n">job_dict</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h3 id="src.sqooler.storage_providers.MongodbProvider.__init__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">login_dict</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Set up the neccessary keys and create the client through which all the connections will run.</p>

          <details class="quote">
            <summary>Source code in <code>src/sqooler/storage_providers.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">login_dict</span><span class="p">:</span> <span class="n">MongodbLoginInformation</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Set up the neccessary keys and create the client through which all the connections will run.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">mongodb_username</span> <span class="o">=</span> <span class="n">login_dict</span><span class="o">.</span><span class="n">mongodb_username</span>
    <span class="n">mongodb_password</span> <span class="o">=</span> <span class="n">login_dict</span><span class="o">.</span><span class="n">mongodb_password</span>
    <span class="n">mongodb_database_url</span> <span class="o">=</span> <span class="n">login_dict</span><span class="o">.</span><span class="n">mongodb_database_url</span>

    <span class="n">uri</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;mongodb+srv://</span><span class="si">{</span><span class="n">mongodb_username</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">mongodb_password</span><span class="si">}</span><span class="s2">@</span><span class="si">{</span><span class="n">mongodb_database_url</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="n">uri</span> <span class="o">=</span> <span class="n">uri</span> <span class="o">+</span> <span class="s2">&quot;/?retryWrites=true&amp;w=majority&quot;</span>
    <span class="c1"># Create a new client and connect to the server</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="p">:</span> <span class="n">MongoClient</span> <span class="o">=</span> <span class="n">MongoClient</span><span class="p">(</span><span class="n">uri</span><span class="p">)</span>

    <span class="c1"># Send a ping to confirm a successful connection</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">admin</span><span class="o">.</span><span class="n">command</span><span class="p">(</span><span class="s2">&quot;ping&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="src.sqooler.storage_providers.MongodbProvider.delete_file" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">delete_file</span><span class="p">(</span><span class="n">storage_path</span><span class="p">,</span> <span class="n">job_id</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Remove the file from the mongodb database</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>storage_path</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the path where the file is currently stored, but excluding the file name</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>job_id</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the name of the file</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>None</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/sqooler/storage_providers.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">delete_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">storage_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">job_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Remove the file from the mongodb database</span>

<span class="sd">    Args:</span>
<span class="sd">        storage_path: the path where the file is currently stored, but excluding the file name</span>
<span class="sd">        job_id: the name of the file</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># get the database on which we work</span>
    <span class="n">database</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="p">[</span><span class="n">storage_path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]]</span>

    <span class="c1"># get the collection on which we work</span>
    <span class="n">collection_name</span> <span class="o">=</span> <span class="s2">&quot;.&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">storage_path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">:])</span>
    <span class="n">collection</span> <span class="o">=</span> <span class="n">database</span><span class="p">[</span><span class="n">collection_name</span><span class="p">]</span>

    <span class="n">document_to_find</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;_id&quot;</span><span class="p">:</span> <span class="n">ObjectId</span><span class="p">(</span><span class="n">job_id</span><span class="p">)}</span>
    <span class="n">collection</span><span class="o">.</span><span class="n">delete_one</span><span class="p">(</span><span class="n">document_to_find</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="src.sqooler.storage_providers.MongodbProvider.get_file_content" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_file_content</span><span class="p">(</span><span class="n">storage_path</span><span class="p">,</span> <span class="n">job_id</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Get the file content from the storage</p>
<p>storage_path: the path towards the file, excluding the filename / id
job_id: the id of the file we are about to look up</p>

          <details class="quote">
            <summary>Source code in <code>src/sqooler/storage_providers.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_file_content</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">storage_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">job_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the file content from the storage</span>

<span class="sd">    storage_path: the path towards the file, excluding the filename / id</span>
<span class="sd">    job_id: the id of the file we are about to look up</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">document_to_find</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;_id&quot;</span><span class="p">:</span> <span class="n">ObjectId</span><span class="p">(</span><span class="n">job_id</span><span class="p">)}</span>

    <span class="c1"># get the database on which we work</span>
    <span class="n">database</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="p">[</span><span class="n">storage_path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]]</span>

    <span class="c1"># get the collection on which we work</span>
    <span class="n">collection_name</span> <span class="o">=</span> <span class="s2">&quot;.&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">storage_path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">:])</span>
    <span class="n">collection</span> <span class="o">=</span> <span class="n">database</span><span class="p">[</span><span class="n">collection_name</span><span class="p">]</span>

    <span class="n">result_found</span> <span class="o">=</span> <span class="n">collection</span><span class="o">.</span><span class="n">find_one</span><span class="p">(</span><span class="n">document_to_find</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">result_found</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">{}</span>
    <span class="k">return</span> <span class="n">result_found</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="src.sqooler.storage_providers.MongodbProvider.get_file_queue" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_file_queue</span><span class="p">(</span><span class="n">storage_path</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Get a list of documents in the collection of all the queued jobs.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>storage_path</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Where are we looking for the files.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>list[str]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A list of files that was found.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/sqooler/storage_providers.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_file_queue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">storage_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get a list of documents in the collection of all the queued jobs.</span>

<span class="sd">    Args:</span>
<span class="sd">        storage_path: Where are we looking for the files.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A list of files that was found.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># strip trailing and leading slashes from the paths</span>
    <span class="n">storage_path</span> <span class="o">=</span> <span class="n">storage_path</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span>

    <span class="c1"># get the database on which we work</span>
    <span class="n">database</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="p">[</span><span class="n">storage_path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]]</span>

    <span class="c1"># get the collection on which we work</span>
    <span class="n">collection_name</span> <span class="o">=</span> <span class="s2">&quot;.&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">storage_path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">:])</span>
    <span class="n">collection</span> <span class="o">=</span> <span class="n">database</span><span class="p">[</span><span class="n">collection_name</span><span class="p">]</span>

    <span class="c1"># now get the id of all the documents in the collection</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">collection</span><span class="o">.</span><span class="n">find</span><span class="p">({},</span> <span class="p">{</span><span class="s2">&quot;_id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
    <span class="n">file_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
        <span class="n">file_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="s2">&quot;_id&quot;</span><span class="p">]))</span>
    <span class="k">return</span> <span class="n">file_list</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="src.sqooler.storage_providers.MongodbProvider.get_job_content" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_job_content</span><span class="p">(</span><span class="n">storage_path</span><span class="p">,</span> <span class="n">job_id</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Get the content of the job from the storage. This is a wrapper around get_file_content
and and handles the different ways of identifiying the job.</p>
<p>storage_path: the path towards the file, excluding the filename / id
job_id: the id of the file we are about to look up</p>
<p>Returns:</p>

          <details class="quote">
            <summary>Source code in <code>src/sqooler/storage_providers.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_job_content</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">storage_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">job_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the content of the job from the storage. This is a wrapper around get_file_content</span>
<span class="sd">    and and handles the different ways of identifiying the job.</span>

<span class="sd">    storage_path: the path towards the file, excluding the filename / id</span>
<span class="sd">    job_id: the id of the file we are about to look up</span>

<span class="sd">    Returns:</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">job_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_file_content</span><span class="p">(</span><span class="n">storage_path</span><span class="o">=</span><span class="n">storage_path</span><span class="p">,</span> <span class="n">job_id</span><span class="o">=</span><span class="n">job_id</span><span class="p">)</span>
    <span class="n">job_dict</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;_id&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">job_dict</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="src.sqooler.storage_providers.MongodbProvider.get_next_job_in_queue" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_next_job_in_queue</span><span class="p">(</span><span class="n">backend_name</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>A function that obtains the next job in the queue. It looks in the queued folder and moves the
first job to the running folder.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>backend_name</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The name of the backend</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the path towards the job</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/sqooler/storage_providers.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_next_job_in_queue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">backend_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A function that obtains the next job in the queue. It looks in the queued folder and moves the</span>
<span class="sd">    first job to the running folder.</span>

<span class="sd">    Args:</span>
<span class="sd">        backend_name (str): The name of the backend</span>

<span class="sd">    Returns:</span>
<span class="sd">        the path towards the job</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">queue_dir</span> <span class="o">=</span> <span class="s2">&quot;jobs/queued/&quot;</span> <span class="o">+</span> <span class="n">backend_name</span>
    <span class="n">job_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;job_id&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;job_json_path&quot;</span><span class="p">:</span> <span class="s2">&quot;None&quot;</span><span class="p">}</span>
    <span class="n">job_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_file_queue</span><span class="p">(</span><span class="n">queue_dir</span><span class="p">)</span>
    <span class="c1"># if there is a job, we should move it</span>
    <span class="k">if</span> <span class="n">job_list</span><span class="p">:</span>
        <span class="n">job_id</span> <span class="o">=</span> <span class="n">job_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">job_dict</span><span class="p">[</span><span class="s2">&quot;job_id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">job_id</span>

        <span class="c1"># and move the file into the right directory</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">move_file</span><span class="p">(</span><span class="n">queue_dir</span><span class="p">,</span> <span class="s2">&quot;jobs/running&quot;</span><span class="p">,</span> <span class="n">job_id</span><span class="p">)</span>
        <span class="n">job_dict</span><span class="p">[</span><span class="s2">&quot;job_json_path&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;jobs/running&quot;</span>
    <span class="k">return</span> <span class="n">job_dict</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="src.sqooler.storage_providers.MongodbProvider.move_file" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">move_file</span><span class="p">(</span><span class="n">start_path</span><span class="p">,</span> <span class="n">final_path</span><span class="p">,</span> <span class="n">job_id</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Move the file from start_path to final_path</p>
<p>start_path: the path where the file is currently stored, but excluding the file name
final_path: the path where the file should be stored, but excluding the file name
job_id: the name of the file. Is a json file</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>None</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/sqooler/storage_providers.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">move_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">final_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">job_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Move the file from start_path to final_path</span>

<span class="sd">    start_path: the path where the file is currently stored, but excluding the file name</span>
<span class="sd">    final_path: the path where the file should be stored, but excluding the file name</span>
<span class="sd">    job_id: the name of the file. Is a json file</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># get the database on which we work</span>
    <span class="n">database</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="p">[</span><span class="n">start_path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]]</span>

    <span class="c1"># get the collection on which we work</span>
    <span class="n">collection_name</span> <span class="o">=</span> <span class="s2">&quot;.&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">start_path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">:])</span>
    <span class="n">collection</span> <span class="o">=</span> <span class="n">database</span><span class="p">[</span><span class="n">collection_name</span><span class="p">]</span>

    <span class="n">document_to_find</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;_id&quot;</span><span class="p">:</span> <span class="n">ObjectId</span><span class="p">(</span><span class="n">job_id</span><span class="p">)}</span>
    <span class="n">result_found</span> <span class="o">=</span> <span class="n">collection</span><span class="o">.</span><span class="n">find_one</span><span class="p">(</span><span class="n">document_to_find</span><span class="p">)</span>

    <span class="c1"># delete the old file</span>
    <span class="n">collection</span><span class="o">.</span><span class="n">delete_one</span><span class="p">(</span><span class="n">document_to_find</span><span class="p">)</span>

    <span class="c1"># add the document to the new collection</span>
    <span class="n">database</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="p">[</span><span class="n">final_path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]]</span>
    <span class="n">collection_name</span> <span class="o">=</span> <span class="s2">&quot;.&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">final_path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">:])</span>
    <span class="n">collection</span> <span class="o">=</span> <span class="n">database</span><span class="p">[</span><span class="n">collection_name</span><span class="p">]</span>
    <span class="n">collection</span><span class="o">.</span><span class="n">insert_one</span><span class="p">(</span><span class="n">result_found</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="src.sqooler.storage_providers.MongodbProvider.update_file" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">update_file</span><span class="p">(</span><span class="n">content_dict</span><span class="p">,</span> <span class="n">storage_path</span><span class="p">,</span> <span class="n">job_id</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Update the file content.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>content_dict</code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The dictionary containing the new content of the file</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>storage_path</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The path to the file</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>job_id</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The id of the job</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>None</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/sqooler/storage_providers.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">update_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">storage_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">job_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Update the file content.</span>

<span class="sd">    Args:</span>
<span class="sd">        content_dict: The dictionary containing the new content of the file</span>
<span class="sd">        storage_path: The path to the file</span>
<span class="sd">        job_id: The id of the job</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># get the database on which we work</span>
    <span class="n">database</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="p">[</span><span class="n">storage_path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]]</span>

    <span class="c1"># get the collection on which we work</span>
    <span class="n">collection_name</span> <span class="o">=</span> <span class="s2">&quot;.&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">storage_path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">:])</span>
    <span class="n">collection</span> <span class="o">=</span> <span class="n">database</span><span class="p">[</span><span class="n">collection_name</span><span class="p">]</span>

    <span class="n">filter_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;_id&quot;</span><span class="p">:</span> <span class="n">ObjectId</span><span class="p">(</span><span class="n">job_id</span><span class="p">)}</span>

    <span class="n">newvalues</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;$set&quot;</span><span class="p">:</span> <span class="n">content_dict</span><span class="p">}</span>
    <span class="n">collection</span><span class="o">.</span><span class="n">update_one</span><span class="p">(</span><span class="n">filter_dict</span><span class="p">,</span> <span class="n">newvalues</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="src.sqooler.storage_providers.MongodbProvider.update_in_database" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">update_in_database</span><span class="p">(</span><span class="n">result_dict</span><span class="p">,</span> <span class="n">status_msg_dict</span><span class="p">,</span> <span class="n">job_id</span><span class="p">,</span> <span class="n">backend_name</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Upload the status and result to the <code>StorageProvider</code>.</p>
<p>The function checks if the reported status of the job has changed to DONE. If so, it will create
a result json file and move the job json file to the finished folder. It will also update the
status json file.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>result_dict</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="src.sqooler.schemes.ResultDict" href="#src.sqooler.schemes.ResultDict">ResultDict</a> | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the dictionary containing the result of the job</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>status_msg_dict</code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the dictionary containing the status message of the job</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>job_id</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the name of the job</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>backend_name</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the name of the backend</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>None</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>
      <p>Raises:</p>

          <details class="quote">
            <summary>Source code in <code>src/sqooler/storage_providers.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">update_in_database</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">result_dict</span><span class="p">:</span> <span class="n">ResultDict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">status_msg_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
    <span class="n">job_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">backend_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Upload the status and result to the `StorageProvider`.</span>

<span class="sd">    The function checks if the reported status of the job has changed to DONE. If so, it will create</span>
<span class="sd">    a result json file and move the job json file to the finished folder. It will also update the</span>
<span class="sd">    status json file.</span>

<span class="sd">    Args:</span>
<span class="sd">        result_dict: the dictionary containing the result of the job</span>
<span class="sd">        status_msg_dict: the dictionary containing the status message of the job</span>
<span class="sd">        job_id: the name of the job</span>
<span class="sd">        backend_name: the name of the backend</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>

<span class="sd">    Raises:</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">job_json_start_dir</span> <span class="o">=</span> <span class="s2">&quot;jobs/running&quot;</span>
    <span class="c1"># check if the job is done or had an error</span>
    <span class="k">if</span> <span class="n">status_msg_dict</span><span class="p">[</span><span class="s2">&quot;status&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;DONE&quot;</span><span class="p">:</span>
        <span class="c1"># test if the result dict is None</span>
        <span class="k">if</span> <span class="n">result_dict</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;The &#39;result_dict&#39; argument cannot be None if the job is done.&quot;</span>
            <span class="p">)</span>
        <span class="c1"># let us create the result json file</span>
        <span class="n">result_json_dir</span> <span class="o">=</span> <span class="s2">&quot;results/&quot;</span> <span class="o">+</span> <span class="n">backend_name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">upload</span><span class="p">(</span><span class="n">result_dict</span><span class="p">,</span> <span class="n">result_json_dir</span><span class="p">,</span> <span class="n">job_id</span><span class="p">)</span>

        <span class="c1"># now move the job out of the running jobs into the finished jobs</span>
        <span class="n">job_finished_json_dir</span> <span class="o">=</span> <span class="s2">&quot;jobs/finished/&quot;</span> <span class="o">+</span> <span class="n">backend_name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">move_file</span><span class="p">(</span><span class="n">job_json_start_dir</span><span class="p">,</span> <span class="n">job_finished_json_dir</span><span class="p">,</span> <span class="n">job_id</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">status_msg_dict</span><span class="p">[</span><span class="s2">&quot;status&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;ERROR&quot;</span><span class="p">:</span>
        <span class="c1"># because there was an error, we move the job to the deleted jobs</span>
        <span class="n">deleted_json_dir</span> <span class="o">=</span> <span class="s2">&quot;jobs/deleted&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">move_file</span><span class="p">(</span><span class="n">job_json_start_dir</span><span class="p">,</span> <span class="n">deleted_json_dir</span><span class="p">,</span> <span class="n">job_id</span><span class="p">)</span>

    <span class="c1"># TODO: most likely we should raise an error if the status of the job is not DONE or ERROR</span>

    <span class="c1"># and create the status json file</span>
    <span class="n">status_json_dir</span> <span class="o">=</span> <span class="s2">&quot;status/&quot;</span> <span class="o">+</span> <span class="n">backend_name</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">update_file</span><span class="p">(</span><span class="n">status_msg_dict</span><span class="p">,</span> <span class="n">status_json_dir</span><span class="p">,</span> <span class="n">job_id</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="src.sqooler.storage_providers.MongodbProvider.upload" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">upload</span><span class="p">(</span><span class="n">content_dict</span><span class="p">,</span> <span class="n">storage_path</span><span class="p">,</span> <span class="n">job_id</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Upload the file to the storage</p>
<p>content_dict: the content that should be uploaded onto the mongodb base
storage_path: the access path towards the mongodb collection
job_id: the id of the file we are about to create</p>

          <details class="quote">
            <summary>Source code in <code>src/sqooler/storage_providers.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">upload</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content_dict</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">,</span> <span class="n">storage_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">job_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Upload the file to the storage</span>

<span class="sd">    content_dict: the content that should be uploaded onto the mongodb base</span>
<span class="sd">    storage_path: the access path towards the mongodb collection</span>
<span class="sd">    job_id: the id of the file we are about to create</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">storage_splitted</span> <span class="o">=</span> <span class="n">storage_path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span>

    <span class="c1"># get the database on which we work</span>
    <span class="n">database</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="p">[</span><span class="n">storage_splitted</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>

    <span class="c1"># get the collection on which we work</span>
    <span class="n">collection_name</span> <span class="o">=</span> <span class="s2">&quot;.&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">storage_splitted</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
    <span class="n">collection</span> <span class="o">=</span> <span class="n">database</span><span class="p">[</span><span class="n">collection_name</span><span class="p">]</span>

    <span class="n">content_dict</span><span class="p">[</span><span class="s2">&quot;_id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ObjectId</span><span class="p">(</span><span class="n">job_id</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
    <span class="n">collection</span><span class="o">.</span><span class="n">insert_one</span><span class="p">(</span><span class="n">content_dict</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="src.sqooler.storage_providers.MongodbProvider.upload_config" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">upload_config</span><span class="p">(</span><span class="n">config_dict</span><span class="p">,</span> <span class="n">backend_name</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>The function that uploads the spooler configuration to the storage.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>config_dict</code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The dictionary containing the configuration</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>backend_name</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The name of the backend</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>None</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/sqooler/storage_providers.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">upload_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">backend_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The function that uploads the spooler configuration to the storage.</span>

<span class="sd">    Args:</span>
<span class="sd">        config_dict: The dictionary containing the configuration</span>
<span class="sd">        backend_name (str): The name of the backend</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">config_path</span> <span class="o">=</span> <span class="s2">&quot;backends/configs&quot;</span>

    <span class="c1"># first we have to check if the device already exists in the database</span>

    <span class="n">document_to_find</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;display_name&quot;</span><span class="p">:</span> <span class="n">backend_name</span><span class="p">}</span>

    <span class="c1"># get the database on which we work</span>
    <span class="n">database</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="p">[</span><span class="s2">&quot;backends&quot;</span><span class="p">]</span>

    <span class="c1"># get the collection on which we work</span>
    <span class="n">collection</span> <span class="o">=</span> <span class="n">database</span><span class="p">[</span><span class="s2">&quot;configs&quot;</span><span class="p">]</span>

    <span class="n">result_found</span> <span class="o">=</span> <span class="n">collection</span><span class="o">.</span><span class="n">find_one</span><span class="p">(</span><span class="n">document_to_find</span><span class="p">)</span>
    <span class="n">config_dict</span><span class="p">[</span><span class="s2">&quot;display_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">backend_name</span>
    <span class="k">if</span> <span class="n">result_found</span><span class="p">:</span>
        <span class="c1"># update the file</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_file</span><span class="p">(</span>
            <span class="n">content_dict</span><span class="o">=</span><span class="n">config_dict</span><span class="p">,</span>
            <span class="n">storage_path</span><span class="o">=</span><span class="n">config_path</span><span class="p">,</span>
            <span class="n">job_id</span><span class="o">=</span><span class="n">result_found</span><span class="p">[</span><span class="s2">&quot;_id&quot;</span><span class="p">],</span>
        <span class="p">)</span>
        <span class="k">return</span>

    <span class="c1"># if the device does not exist, we have to create it</span>

    <span class="n">config_id</span> <span class="o">=</span> <span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()</span><span class="o">.</span><span class="n">hex</span><span class="p">[:</span><span class="mi">24</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">upload</span><span class="p">(</span><span class="n">config_dict</span><span class="p">,</span> <span class="n">config_path</span><span class="p">,</span> <span class="n">config_id</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">




<h2 id="src.sqooler.storage_providers.StorageProvider" class="doc doc-heading">
          <code>StorageProvider</code>


</h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="abc.ABC">ABC</span></code></p>

  
      <p>The template for accessing any storage providers like dropbox, mongodb, amazon S3 etc.</p>

            <details class="quote">
              <summary>Source code in <code>src/sqooler/storage_providers.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">StorageProvider</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The template for accessing any storage providers like dropbox, mongodb, amazon S3 etc.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">upload</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content_dict</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">,</span> <span class="n">storage_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">job_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Upload the file to the storage</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">get_file_content</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">storage_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">job_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the file content from the storage</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">get_job_content</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">storage_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">job_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the content of the job from the storage. This is a wrapper around get_file_content</span>
<span class="sd">        and and handles the different ways of identifiying the job.</span>

<span class="sd">        storage_path: the path towards the file, excluding the filename / id</span>
<span class="sd">        job_id: the id of the file we are about to look up</span>

<span class="sd">        Returns:</span>
<span class="sd">            The content of the job</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">update_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">storage_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">job_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Update the file content.</span>

<span class="sd">        Args:</span>
<span class="sd">            content_dict: The dictionary containing the new content of the file</span>
<span class="sd">            storage_path: The path to the file</span>
<span class="sd">            job_id: The id of the job</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">move_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">final_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">job_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Move the file from `start_path` to `final_path`</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">delete_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">storage_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">job_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Delete the file from the storage</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">upload_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">backend_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The function that uploads the spooler configuration to the storage.</span>

<span class="sd">        Args:</span>
<span class="sd">            config_dict: The dictionary containing the configuration</span>
<span class="sd">            backend_name (str): The name of the backend</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">update_in_database</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">result_dict</span><span class="p">:</span> <span class="n">ResultDict</span><span class="p">,</span>
        <span class="n">status_msg_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
        <span class="n">job_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">backend_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Upload the status and result to the `StorageProvider`.</span>

<span class="sd">        Args:</span>
<span class="sd">            result_dict: the dictionary containing the result of the job</span>
<span class="sd">            status_msg_dict: the dictionary containing the status message of the job</span>
<span class="sd">            job_id: the name of the job</span>
<span class="sd">            backend_name: the name of the backend</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">get_file_queue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">storage_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get a list of files</span>

<span class="sd">        Args:</span>
<span class="sd">            storage_path: Where are we looking for the files.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A list of files that was found.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">get_next_job_in_queue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">backend_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A function that obtains the next job in the queue.</span>

<span class="sd">        Args:</span>
<span class="sd">            backend_name (str): The name of the backend</span>

<span class="sd">        Returns:</span>
<span class="sd">            the path towards the job</span>
<span class="sd">        &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h3 id="src.sqooler.storage_providers.StorageProvider.delete_file" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">delete_file</span><span class="p">(</span><span class="n">storage_path</span><span class="p">,</span> <span class="n">job_id</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Delete the file from the storage</p>

          <details class="quote">
            <summary>Source code in <code>src/sqooler/storage_providers.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">def</span> <span class="nf">delete_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">storage_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">job_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Delete the file from the storage</span>
<span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="src.sqooler.storage_providers.StorageProvider.get_file_content" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_file_content</span><span class="p">(</span><span class="n">storage_path</span><span class="p">,</span> <span class="n">job_id</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Get the file content from the storage</p>

          <details class="quote">
            <summary>Source code in <code>src/sqooler/storage_providers.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">def</span> <span class="nf">get_file_content</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">storage_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">job_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the file content from the storage</span>
<span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="src.sqooler.storage_providers.StorageProvider.get_file_queue" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_file_queue</span><span class="p">(</span><span class="n">storage_path</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Get a list of files</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>storage_path</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Where are we looking for the files.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>list[str]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A list of files that was found.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/sqooler/storage_providers.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">def</span> <span class="nf">get_file_queue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">storage_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get a list of files</span>

<span class="sd">    Args:</span>
<span class="sd">        storage_path: Where are we looking for the files.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A list of files that was found.</span>
<span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="src.sqooler.storage_providers.StorageProvider.get_job_content" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_job_content</span><span class="p">(</span><span class="n">storage_path</span><span class="p">,</span> <span class="n">job_id</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Get the content of the job from the storage. This is a wrapper around get_file_content
and and handles the different ways of identifiying the job.</p>
<p>storage_path: the path towards the file, excluding the filename / id
job_id: the id of the file we are about to look up</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The content of the job</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/sqooler/storage_providers.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">def</span> <span class="nf">get_job_content</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">storage_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">job_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the content of the job from the storage. This is a wrapper around get_file_content</span>
<span class="sd">    and and handles the different ways of identifiying the job.</span>

<span class="sd">    storage_path: the path towards the file, excluding the filename / id</span>
<span class="sd">    job_id: the id of the file we are about to look up</span>

<span class="sd">    Returns:</span>
<span class="sd">        The content of the job</span>
<span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="src.sqooler.storage_providers.StorageProvider.get_next_job_in_queue" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_next_job_in_queue</span><span class="p">(</span><span class="n">backend_name</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>A function that obtains the next job in the queue.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>backend_name</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The name of the backend</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the path towards the job</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/sqooler/storage_providers.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">def</span> <span class="nf">get_next_job_in_queue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">backend_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A function that obtains the next job in the queue.</span>

<span class="sd">    Args:</span>
<span class="sd">        backend_name (str): The name of the backend</span>

<span class="sd">    Returns:</span>
<span class="sd">        the path towards the job</span>
<span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="src.sqooler.storage_providers.StorageProvider.move_file" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">move_file</span><span class="p">(</span><span class="n">start_path</span><span class="p">,</span> <span class="n">final_path</span><span class="p">,</span> <span class="n">job_id</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Move the file from <code>start_path</code> to <code>final_path</code></p>

          <details class="quote">
            <summary>Source code in <code>src/sqooler/storage_providers.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">def</span> <span class="nf">move_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">final_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">job_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Move the file from `start_path` to `final_path`</span>
<span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="src.sqooler.storage_providers.StorageProvider.update_file" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">update_file</span><span class="p">(</span><span class="n">content_dict</span><span class="p">,</span> <span class="n">storage_path</span><span class="p">,</span> <span class="n">job_id</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Update the file content.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>content_dict</code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The dictionary containing the new content of the file</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>storage_path</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The path to the file</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>job_id</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The id of the job</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>None</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/sqooler/storage_providers.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">def</span> <span class="nf">update_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">storage_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">job_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Update the file content.</span>

<span class="sd">    Args:</span>
<span class="sd">        content_dict: The dictionary containing the new content of the file</span>
<span class="sd">        storage_path: The path to the file</span>
<span class="sd">        job_id: The id of the job</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>
<span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="src.sqooler.storage_providers.StorageProvider.update_in_database" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">update_in_database</span><span class="p">(</span><span class="n">result_dict</span><span class="p">,</span> <span class="n">status_msg_dict</span><span class="p">,</span> <span class="n">job_id</span><span class="p">,</span> <span class="n">backend_name</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Upload the status and result to the <code>StorageProvider</code>.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>result_dict</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="src.sqooler.schemes.ResultDict" href="#src.sqooler.schemes.ResultDict">ResultDict</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the dictionary containing the result of the job</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>status_msg_dict</code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the dictionary containing the status message of the job</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>job_id</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the name of the job</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>backend_name</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the name of the backend</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>None</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/sqooler/storage_providers.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">def</span> <span class="nf">update_in_database</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">result_dict</span><span class="p">:</span> <span class="n">ResultDict</span><span class="p">,</span>
    <span class="n">status_msg_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
    <span class="n">job_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">backend_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Upload the status and result to the `StorageProvider`.</span>

<span class="sd">    Args:</span>
<span class="sd">        result_dict: the dictionary containing the result of the job</span>
<span class="sd">        status_msg_dict: the dictionary containing the status message of the job</span>
<span class="sd">        job_id: the name of the job</span>
<span class="sd">        backend_name: the name of the backend</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>
<span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="src.sqooler.storage_providers.StorageProvider.upload" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">upload</span><span class="p">(</span><span class="n">content_dict</span><span class="p">,</span> <span class="n">storage_path</span><span class="p">,</span> <span class="n">job_id</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Upload the file to the storage</p>

          <details class="quote">
            <summary>Source code in <code>src/sqooler/storage_providers.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">def</span> <span class="nf">upload</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content_dict</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">,</span> <span class="n">storage_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">job_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Upload the file to the storage</span>
<span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="src.sqooler.storage_providers.StorageProvider.upload_config" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">upload_config</span><span class="p">(</span><span class="n">config_dict</span><span class="p">,</span> <span class="n">backend_name</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>The function that uploads the spooler configuration to the storage.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>config_dict</code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The dictionary containing the configuration</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>backend_name</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The name of the backend</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>None</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/sqooler/storage_providers.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span>
<span class="normal">97</span>
<span class="normal">98</span>
<span class="normal">99</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">def</span> <span class="nf">upload_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">backend_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The function that uploads the spooler configuration to the storage.</span>

<span class="sd">    Args:</span>
<span class="sd">        config_dict: The dictionary containing the configuration</span>
<span class="sd">        backend_name (str): The name of the backend</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>
<span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>




  </div>

  </div>

</div><h2 id="schemes">Schemes</h2>


<div class="doc doc-object doc-module">



<a id="src.sqooler.schemes"></a>
  <div class="doc doc-contents first">
  
      <p>The module that contains common logic for schemes, validation etc.
There is no obvious need, why this code should be touch in a new back-end.</p>

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">




<h2 id="src.sqooler.schemes.DropboxLoginInformation" class="doc doc-heading">
          <code>DropboxLoginInformation</code>


</h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="pydantic.BaseModel">BaseModel</span></code></p>

  
      <p>The login information for the dropbox</p>

            <details class="quote">
              <summary>Source code in <code>src/sqooler/schemes.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">DropboxLoginInformation</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The login information for the dropbox</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">app_key</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">app_secret</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">refresh_token</span><span class="p">:</span> <span class="nb">str</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">











  </div>

  </div>

</div>

<div class="doc doc-object doc-class">




<h2 id="src.sqooler.schemes.ExperimentDict" class="doc doc-heading">
          <code>ExperimentDict</code>


</h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="typing_extensions.TypedDict">TypedDict</span></code></p>

  
      <p>A class that defines the structure of the experiments.</p>

            <details class="quote">
              <summary>Source code in <code>src/sqooler/schemes.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">ExperimentDict</span><span class="p">(</span><span class="n">TypedDict</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A class that defines the structure of the experiments.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">header</span><span class="p">:</span> <span class="nb">dict</span>
    <span class="n">shots</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">success</span><span class="p">:</span> <span class="nb">bool</span>
    <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">











  </div>

  </div>

</div>

<div class="doc doc-object doc-class">




<h2 id="src.sqooler.schemes.GateInstruction" class="doc doc-heading">
          <code>GateInstruction</code>


</h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="pydantic.BaseModel">BaseModel</span></code></p>

  
      <p>The basic class for all the gate intructions of a backend.
Any gate has to have the following attributes.</p>

            <details class="quote">
              <summary>Source code in <code>src/sqooler/schemes.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">GateInstruction</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The basic class for all the gate intructions of a backend.</span>
<span class="sd">    Any gate has to have the following attributes.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">parameters</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">description</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">coupling_map</span><span class="p">:</span> <span class="nb">list</span>
    <span class="n">qasm_def</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">&quot;</span>
    <span class="n">is_gate</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">config_dict</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Give back the properties of the instruction such as needed for the server.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;coupling_map&quot;</span><span class="p">:</span> <span class="bp">cls</span><span class="o">.</span><span class="n">model_fields</span><span class="p">[</span><span class="s2">&quot;coupling_map&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">default</span><span class="p">,</span>
            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="bp">cls</span><span class="o">.</span><span class="n">model_fields</span><span class="p">[</span><span class="s2">&quot;description&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">default</span><span class="p">,</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="bp">cls</span><span class="o">.</span><span class="n">model_fields</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">default</span><span class="p">,</span>
            <span class="s2">&quot;parameters&quot;</span><span class="p">:</span> <span class="p">[</span><span class="bp">cls</span><span class="o">.</span><span class="n">model_fields</span><span class="p">[</span><span class="s2">&quot;parameters&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">default</span><span class="p">],</span>
            <span class="s2">&quot;qasm_def&quot;</span><span class="p">:</span> <span class="bp">cls</span><span class="o">.</span><span class="n">model_fields</span><span class="p">[</span><span class="s2">&quot;qasm_def&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">default</span><span class="p">,</span>
        <span class="p">}</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h3 id="src.sqooler.schemes.GateInstruction.config_dict" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">config_dict</span><span class="p">()</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Give back the properties of the instruction such as needed for the server.</p>

          <details class="quote">
            <summary>Source code in <code>src/sqooler/schemes.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">config_dict</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Give back the properties of the instruction such as needed for the server.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="s2">&quot;coupling_map&quot;</span><span class="p">:</span> <span class="bp">cls</span><span class="o">.</span><span class="n">model_fields</span><span class="p">[</span><span class="s2">&quot;coupling_map&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">default</span><span class="p">,</span>
        <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="bp">cls</span><span class="o">.</span><span class="n">model_fields</span><span class="p">[</span><span class="s2">&quot;description&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">default</span><span class="p">,</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="bp">cls</span><span class="o">.</span><span class="n">model_fields</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">default</span><span class="p">,</span>
        <span class="s2">&quot;parameters&quot;</span><span class="p">:</span> <span class="p">[</span><span class="bp">cls</span><span class="o">.</span><span class="n">model_fields</span><span class="p">[</span><span class="s2">&quot;parameters&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">default</span><span class="p">],</span>
        <span class="s2">&quot;qasm_def&quot;</span><span class="p">:</span> <span class="bp">cls</span><span class="o">.</span><span class="n">model_fields</span><span class="p">[</span><span class="s2">&quot;qasm_def&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">default</span><span class="p">,</span>
    <span class="p">}</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">




<h2 id="src.sqooler.schemes.LocalLoginInformation" class="doc doc-heading">
          <code>LocalLoginInformation</code>


</h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="pydantic.BaseModel">BaseModel</span></code></p>

  
      <p>The login information for a local storage provider.</p>
<p>base_path: The base path of the storage provider on your local file system.</p>

            <details class="quote">
              <summary>Source code in <code>src/sqooler/schemes.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">LocalLoginInformation</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The login information for a local storage provider.</span>

<span class="sd">    base_path: The base path of the storage provider on your local file system.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">base_path</span><span class="p">:</span> <span class="nb">str</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">











  </div>

  </div>

</div>

<div class="doc doc-object doc-class">




<h2 id="src.sqooler.schemes.MongodbLoginInformation" class="doc doc-heading">
          <code>MongodbLoginInformation</code>


</h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="pydantic.BaseModel">BaseModel</span></code></p>

  
      <p>The login information for MongoDB</p>

            <details class="quote">
              <summary>Source code in <code>src/sqooler/schemes.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">MongodbLoginInformation</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The login information for MongoDB</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">mongodb_username</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">mongodb_password</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">mongodb_database_url</span><span class="p">:</span> <span class="nb">str</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">











  </div>

  </div>

</div>

<div class="doc doc-object doc-class">




<h2 id="src.sqooler.schemes.ResultDict" class="doc doc-heading">
          <code>ResultDict</code>


</h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="typing_extensions.TypedDict">TypedDict</span></code></p>

  
      <p>A class that defines the structure of results.</p>

            <details class="quote">
              <summary>Source code in <code>src/sqooler/schemes.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">ResultDict</span><span class="p">(</span><span class="n">TypedDict</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A class that defines the structure of results.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">display_name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">backend_version</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">job_id</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">qobj_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span>
    <span class="n">success</span><span class="p">:</span> <span class="nb">bool</span>
    <span class="n">status</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">header</span><span class="p">:</span> <span class="nb">dict</span>
    <span class="n">results</span><span class="p">:</span> <span class="nb">list</span>
    <span class="n">backend_name</span><span class="p">:</span> <span class="n">NotRequired</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">











  </div>

  </div>

</div>

<div class="doc doc-object doc-class">




<h2 id="src.sqooler.schemes.Spooler" class="doc doc-heading">
          <code>Spooler</code>


</h2>


  <div class="doc doc-contents ">

  
      <p>The class for the spooler. So it is not just a scheme, but it also contains some common logic.
So it should most likely live in another file at some point.</p>



  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>n_max_wires</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>maximum number of wires for the spooler</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>n_max_shots</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the maximum number of shots for the spooler</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>ins_schema_dict</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A dictionary the contains all the allowed instructions for this spooler.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>exper_schema</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Sets the <code>exper_schema</code> attribute of the class</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>ins_schema_dict</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Sets the <code>ins_schema_dict</code> attribute of the class</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

            <details class="quote">
              <summary>Source code in <code>src/sqooler/schemes.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Spooler</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The class for the spooler. So it is not just a scheme, but it also contains some common logic.</span>
<span class="sd">    So it should most likely live in another file at some point.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        n_max_wires: maximum number of wires for the spooler</span>
<span class="sd">        n_max_shots: the maximum number of shots for the spooler</span>
<span class="sd">        ins_schema_dict : A dictionary the contains all the allowed instructions for this spooler.</span>

<span class="sd">    Args:</span>
<span class="sd">        exper_schema: Sets the `exper_schema` attribute of the class</span>
<span class="sd">        ins_schema_dict : Sets the `ins_schema_dict` attribute of the class</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">ins_schema_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
        <span class="n">n_wires</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">description</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="n">n_max_shots</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span>
        <span class="n">version</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;0.0.1&quot;</span><span class="p">,</span>
        <span class="n">cold_atom_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;spin&quot;</span><span class="p">,</span>
        <span class="n">n_max_experiments</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">15</span><span class="p">,</span>
        <span class="n">wire_order</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;interleaved&quot;</span><span class="p">,</span>
        <span class="n">num_species</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The constructor of the class.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ins_schema_dict</span> <span class="o">=</span> <span class="n">ins_schema_dict</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_max_shots</span> <span class="o">=</span> <span class="n">n_max_shots</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_wires</span> <span class="o">=</span> <span class="n">n_wires</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">description</span> <span class="o">=</span> <span class="n">description</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">version</span> <span class="o">=</span> <span class="n">version</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cold_atom_type</span> <span class="o">=</span> <span class="n">cold_atom_type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_max_experiments</span> <span class="o">=</span> <span class="n">n_max_experiments</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wire_order</span> <span class="o">=</span> <span class="n">wire_order</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">num_species</span> <span class="o">=</span> <span class="n">num_species</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_display_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">check_experiment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exper_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Check the validity of the experiment.</span>
<span class="sd">        This has to be implement in each subclass extra.</span>

<span class="sd">        Args:</span>
<span class="sd">            exper_dict: The dictionary that contains the logic and should</span>
<span class="sd">                be verified.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Subclasses should implement this!&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_configuration</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sends back the configuration dictionary of the spooler.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">gate_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">ins_obj</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ins_schema_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="s2">&quot;is_gate&quot;</span> <span class="ow">in</span> <span class="n">ins_obj</span><span class="o">.</span><span class="n">model_fields</span><span class="p">:</span>
                <span class="n">gate_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ins_obj</span><span class="o">.</span><span class="n">config_dict</span><span class="p">())</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">description</span><span class="p">,</span>
            <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">version</span><span class="p">,</span>
            <span class="s2">&quot;cold_atom_type&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">cold_atom_type</span><span class="p">,</span>
            <span class="s2">&quot;gates&quot;</span><span class="p">:</span> <span class="n">gate_list</span><span class="p">,</span>
            <span class="s2">&quot;max_experiments&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_max_experiments</span><span class="p">,</span>
            <span class="s2">&quot;max_shots&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_max_shots</span><span class="p">,</span>
            <span class="s2">&quot;simulator&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
            <span class="s2">&quot;supported_instructions&quot;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ins_schema_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span>
            <span class="s2">&quot;num_wires&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_wires</span><span class="p">,</span>
            <span class="s2">&quot;wire_order&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">wire_order</span><span class="p">,</span>
            <span class="s2">&quot;num_species&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_species</span><span class="p">,</span>
        <span class="p">}</span>

    <span class="k">def</span> <span class="nf">check_instructions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ins_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Check all the instruction to make sure that they are valid.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">err_code</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">exp_ok</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">ins</span> <span class="ow">in</span> <span class="n">ins_list</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">gate_dict</span> <span class="o">=</span> <span class="n">gate_dict_from_list</span><span class="p">(</span><span class="n">ins</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ins_schema_dict</span><span class="p">[</span><span class="n">ins</span><span class="p">[</span><span class="mi">0</span><span class="p">]](</span><span class="o">**</span><span class="n">gate_dict</span><span class="p">)</span>
                <span class="n">exp_ok</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">except</span> <span class="n">ValidationError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
                <span class="n">err_code</span> <span class="o">=</span> <span class="s2">&quot;Error in instruction &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
                <span class="n">exp_ok</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">exp_ok</span><span class="p">:</span>
                <span class="k">break</span>
        <span class="k">return</span> <span class="n">err_code</span><span class="p">,</span> <span class="n">exp_ok</span>

    <span class="k">def</span> <span class="nf">check_dimension</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">json_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Make sure that the Hilbert space dimension is not too large.</span>

<span class="sd">        It can be implemented in the class that inherits, but it is not necessary.</span>
<span class="sd">        So this is only a placeholder.</span>

<span class="sd">        Args:</span>
<span class="sd">            json_dict: the dictonary with the instructions</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: the error message</span>
<span class="sd">            bool: is the dimension ok ?</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># pylint: disable=W0613</span>
        <span class="k">return</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">check_json_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">json_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Check if the json file has the appropiate syntax.</span>

<span class="sd">        Args:</span>
<span class="sd">            json_dict (dict): the dictonary that we will test.</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: is the expression having the appropiate syntax ?</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">expr</span> <span class="ow">in</span> <span class="n">json_dict</span><span class="p">:</span>
            <span class="n">err_code</span> <span class="o">=</span> <span class="s2">&quot;Wrong experiment name or too many experiments&quot;</span>
            <span class="c1"># Fix this pylint issue whenever you have time, but be careful !</span>
            <span class="c1"># pylint: disable=W0702</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">exp_ok</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">expr</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;experiment_&quot;</span><span class="p">)</span>
                    <span class="ow">and</span> <span class="n">expr</span><span class="p">[</span><span class="mi">11</span><span class="p">:]</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()</span>
                    <span class="ow">and</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">expr</span><span class="p">[</span><span class="mi">11</span><span class="p">:])</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_max_experiments</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">exp_ok</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">break</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">exp_ok</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="c1"># test the structure of the experiment</span>
            <span class="n">err_code</span><span class="p">,</span> <span class="n">exp_ok</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_experiment</span><span class="p">(</span><span class="n">json_dict</span><span class="p">[</span><span class="n">expr</span><span class="p">])</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">exp_ok</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="c1"># time to check the structure of the instructions</span>
            <span class="n">ins_list</span> <span class="o">=</span> <span class="n">json_dict</span><span class="p">[</span><span class="n">expr</span><span class="p">][</span><span class="s2">&quot;instructions&quot;</span><span class="p">]</span>
            <span class="n">err_code</span><span class="p">,</span> <span class="n">exp_ok</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_instructions</span><span class="p">(</span><span class="n">ins_list</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">exp_ok</span><span class="p">:</span>
                <span class="k">break</span>
        <span class="k">return</span> <span class="n">err_code</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;..&quot;</span><span class="p">),</span> <span class="n">exp_ok</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">display_name</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The name of the spooler.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_display_name</span>

    <span class="nd">@display_name</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">display_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>  <span class="c1"># Check if the provided value is a string</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_display_name</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;display_name must be a string&quot;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">gen_circuit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">dict</span><span class="p">],</span> <span class="n">ExperimentDict</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The function that generates the circuit.</span>
<span class="sd">        It can be basically anything that allows the execution of the circuit.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gen_circuit</span>

    <span class="nd">@gen_circuit</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">gen_circuit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">dict</span><span class="p">],</span> <span class="n">ExperimentDict</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">callable</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>  <span class="c1"># Check if the provided value is a callable (function)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_gen_circuit</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;gen_circuit must be a callable function&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_job</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">json_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">status_msg_dict</span><span class="p">:</span> <span class="nb">dict</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">ResultDict</span><span class="p">,</span> <span class="nb">dict</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The function that translates the json with the instructions into some circuit and executes it.</span>
<span class="sd">        It performs several checks for the job to see if it is properly working.</span>
<span class="sd">        If things are fine the job gets added the list of things that should be executed.</span>

<span class="sd">        json_dict: The job dictonary of all the instructions.</span>
<span class="sd">        status_msg_dict: the status dictionary of the job we are treating.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">job_id</span> <span class="o">=</span> <span class="n">status_msg_dict</span><span class="p">[</span><span class="s2">&quot;job_id&quot;</span><span class="p">]</span>

        <span class="n">result_dict</span><span class="p">:</span> <span class="n">ResultDict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;display_name&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">display_name</span><span class="p">,</span>
            <span class="s2">&quot;backend_version&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">version</span><span class="p">,</span>
            <span class="s2">&quot;job_id&quot;</span><span class="p">:</span> <span class="n">job_id</span><span class="p">,</span>
            <span class="s2">&quot;qobj_id&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
            <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;finished&quot;</span><span class="p">,</span>
            <span class="s2">&quot;header&quot;</span><span class="p">:</span> <span class="p">{},</span>
            <span class="s2">&quot;results&quot;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="p">}</span>
        <span class="n">err_msg</span><span class="p">,</span> <span class="n">json_is_fine</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_json_dict</span><span class="p">(</span><span class="n">json_dict</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">json_is_fine</span><span class="p">:</span>
            <span class="c1"># check_hilbert_space_dimension</span>
            <span class="n">dim_err_msg</span><span class="p">,</span> <span class="n">dim_ok</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_dimension</span><span class="p">(</span><span class="n">json_dict</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">dim_ok</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">exp</span> <span class="ow">in</span> <span class="n">json_dict</span><span class="p">:</span>
                    <span class="n">exp_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">exp</span><span class="p">:</span> <span class="n">json_dict</span><span class="p">[</span><span class="n">exp</span><span class="p">]}</span>
                    <span class="c1"># Here we</span>
                    <span class="n">result_dict</span><span class="p">[</span><span class="s2">&quot;results&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gen_circuit</span><span class="p">(</span><span class="n">exp_dict</span><span class="p">))</span>

                <span class="n">status_msg_dict</span><span class="p">[</span>
                    <span class="s2">&quot;detail&quot;</span>
                <span class="p">]</span> <span class="o">+=</span> <span class="s2">&quot;; Passed json sanity check; Compilation done. Shots sent to solver.&quot;</span>
                <span class="n">status_msg_dict</span><span class="p">[</span><span class="s2">&quot;status&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;DONE&quot;</span>
                <span class="k">return</span> <span class="n">result_dict</span><span class="p">,</span> <span class="n">status_msg_dict</span>

            <span class="n">status_msg_dict</span><span class="p">[</span><span class="s2">&quot;detail&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span>
                <span class="s2">&quot;; Failed dimensionality test. Too many atoms. File will be deleted. Error message : &quot;</span>
                <span class="o">+</span> <span class="n">dim_err_msg</span>
            <span class="p">)</span>
            <span class="n">status_msg_dict</span><span class="p">[</span><span class="s2">&quot;error_message&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span>
                <span class="s2">&quot;; Failed dimensionality test. Too many atoms. File will be deleted. Error message :  &quot;</span>
                <span class="o">+</span> <span class="n">dim_err_msg</span>
            <span class="p">)</span>
            <span class="n">status_msg_dict</span><span class="p">[</span><span class="s2">&quot;status&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;ERROR&quot;</span>
            <span class="k">return</span> <span class="n">result_dict</span><span class="p">,</span> <span class="n">status_msg_dict</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">status_msg_dict</span><span class="p">[</span><span class="s2">&quot;detail&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span>
                <span class="s2">&quot;; Failed json sanity check. File will be deleted. Error message : &quot;</span>
                <span class="o">+</span> <span class="n">err_msg</span>
            <span class="p">)</span>
            <span class="n">status_msg_dict</span><span class="p">[</span><span class="s2">&quot;error_message&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span>
                <span class="s2">&quot;; Failed json sanity check. File will be deleted. Error message : &quot;</span>
                <span class="o">+</span> <span class="n">err_msg</span>
            <span class="p">)</span>
            <span class="n">status_msg_dict</span><span class="p">[</span><span class="s2">&quot;status&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;ERROR&quot;</span>
        <span class="k">return</span> <span class="n">result_dict</span><span class="p">,</span> <span class="n">status_msg_dict</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">




<h3 id="src.sqooler.schemes.Spooler.display_name" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">display_name</span><span class="p">:</span> <span class="nb">str</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>The name of the spooler.</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">




<h3 id="src.sqooler.schemes.Spooler.gen_circuit" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">gen_circuit</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">dict</span><span class="p">],</span> <span class="n">ExperimentDict</span><span class="p">]</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>The function that generates the circuit.
It can be basically anything that allows the execution of the circuit.</p>
  </div>

</div>




<div class="doc doc-object doc-function">




<h3 id="src.sqooler.schemes.Spooler.__init__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">ins_schema_dict</span><span class="p">,</span> <span class="n">n_wires</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">n_max_shots</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="s1">&#39;0.0.1&#39;</span><span class="p">,</span> <span class="n">cold_atom_type</span><span class="o">=</span><span class="s1">&#39;spin&#39;</span><span class="p">,</span> <span class="n">n_max_experiments</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">wire_order</span><span class="o">=</span><span class="s1">&#39;interleaved&#39;</span><span class="p">,</span> <span class="n">num_species</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>The constructor of the class.</p>

          <details class="quote">
            <summary>Source code in <code>src/sqooler/schemes.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">ins_schema_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
    <span class="n">n_wires</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">description</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">n_max_shots</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span>
    <span class="n">version</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;0.0.1&quot;</span><span class="p">,</span>
    <span class="n">cold_atom_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;spin&quot;</span><span class="p">,</span>
    <span class="n">n_max_experiments</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">15</span><span class="p">,</span>
    <span class="n">wire_order</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;interleaved&quot;</span><span class="p">,</span>
    <span class="n">num_species</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The constructor of the class.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ins_schema_dict</span> <span class="o">=</span> <span class="n">ins_schema_dict</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">n_max_shots</span> <span class="o">=</span> <span class="n">n_max_shots</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">n_wires</span> <span class="o">=</span> <span class="n">n_wires</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">description</span> <span class="o">=</span> <span class="n">description</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">version</span> <span class="o">=</span> <span class="n">version</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">cold_atom_type</span> <span class="o">=</span> <span class="n">cold_atom_type</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">n_max_experiments</span> <span class="o">=</span> <span class="n">n_max_experiments</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">wire_order</span> <span class="o">=</span> <span class="n">wire_order</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">num_species</span> <span class="o">=</span> <span class="n">num_species</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_display_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="src.sqooler.schemes.Spooler.add_job" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">add_job</span><span class="p">(</span><span class="n">json_dict</span><span class="p">,</span> <span class="n">status_msg_dict</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>The function that translates the json with the instructions into some circuit and executes it.
It performs several checks for the job to see if it is properly working.
If things are fine the job gets added the list of things that should be executed.</p>
<p>json_dict: The job dictonary of all the instructions.
status_msg_dict: the status dictionary of the job we are treating.</p>

          <details class="quote">
            <summary>Source code in <code>src/sqooler/schemes.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">add_job</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">json_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">status_msg_dict</span><span class="p">:</span> <span class="nb">dict</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">ResultDict</span><span class="p">,</span> <span class="nb">dict</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The function that translates the json with the instructions into some circuit and executes it.</span>
<span class="sd">    It performs several checks for the job to see if it is properly working.</span>
<span class="sd">    If things are fine the job gets added the list of things that should be executed.</span>

<span class="sd">    json_dict: The job dictonary of all the instructions.</span>
<span class="sd">    status_msg_dict: the status dictionary of the job we are treating.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">job_id</span> <span class="o">=</span> <span class="n">status_msg_dict</span><span class="p">[</span><span class="s2">&quot;job_id&quot;</span><span class="p">]</span>

    <span class="n">result_dict</span><span class="p">:</span> <span class="n">ResultDict</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;display_name&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">display_name</span><span class="p">,</span>
        <span class="s2">&quot;backend_version&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">version</span><span class="p">,</span>
        <span class="s2">&quot;job_id&quot;</span><span class="p">:</span> <span class="n">job_id</span><span class="p">,</span>
        <span class="s2">&quot;qobj_id&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
        <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;finished&quot;</span><span class="p">,</span>
        <span class="s2">&quot;header&quot;</span><span class="p">:</span> <span class="p">{},</span>
        <span class="s2">&quot;results&quot;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="p">}</span>
    <span class="n">err_msg</span><span class="p">,</span> <span class="n">json_is_fine</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_json_dict</span><span class="p">(</span><span class="n">json_dict</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">json_is_fine</span><span class="p">:</span>
        <span class="c1"># check_hilbert_space_dimension</span>
        <span class="n">dim_err_msg</span><span class="p">,</span> <span class="n">dim_ok</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_dimension</span><span class="p">(</span><span class="n">json_dict</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">dim_ok</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">exp</span> <span class="ow">in</span> <span class="n">json_dict</span><span class="p">:</span>
                <span class="n">exp_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">exp</span><span class="p">:</span> <span class="n">json_dict</span><span class="p">[</span><span class="n">exp</span><span class="p">]}</span>
                <span class="c1"># Here we</span>
                <span class="n">result_dict</span><span class="p">[</span><span class="s2">&quot;results&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gen_circuit</span><span class="p">(</span><span class="n">exp_dict</span><span class="p">))</span>

            <span class="n">status_msg_dict</span><span class="p">[</span>
                <span class="s2">&quot;detail&quot;</span>
            <span class="p">]</span> <span class="o">+=</span> <span class="s2">&quot;; Passed json sanity check; Compilation done. Shots sent to solver.&quot;</span>
            <span class="n">status_msg_dict</span><span class="p">[</span><span class="s2">&quot;status&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;DONE&quot;</span>
            <span class="k">return</span> <span class="n">result_dict</span><span class="p">,</span> <span class="n">status_msg_dict</span>

        <span class="n">status_msg_dict</span><span class="p">[</span><span class="s2">&quot;detail&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span>
            <span class="s2">&quot;; Failed dimensionality test. Too many atoms. File will be deleted. Error message : &quot;</span>
            <span class="o">+</span> <span class="n">dim_err_msg</span>
        <span class="p">)</span>
        <span class="n">status_msg_dict</span><span class="p">[</span><span class="s2">&quot;error_message&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span>
            <span class="s2">&quot;; Failed dimensionality test. Too many atoms. File will be deleted. Error message :  &quot;</span>
            <span class="o">+</span> <span class="n">dim_err_msg</span>
        <span class="p">)</span>
        <span class="n">status_msg_dict</span><span class="p">[</span><span class="s2">&quot;status&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;ERROR&quot;</span>
        <span class="k">return</span> <span class="n">result_dict</span><span class="p">,</span> <span class="n">status_msg_dict</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">status_msg_dict</span><span class="p">[</span><span class="s2">&quot;detail&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span>
            <span class="s2">&quot;; Failed json sanity check. File will be deleted. Error message : &quot;</span>
            <span class="o">+</span> <span class="n">err_msg</span>
        <span class="p">)</span>
        <span class="n">status_msg_dict</span><span class="p">[</span><span class="s2">&quot;error_message&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span>
            <span class="s2">&quot;; Failed json sanity check. File will be deleted. Error message : &quot;</span>
            <span class="o">+</span> <span class="n">err_msg</span>
        <span class="p">)</span>
        <span class="n">status_msg_dict</span><span class="p">[</span><span class="s2">&quot;status&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;ERROR&quot;</span>
    <span class="k">return</span> <span class="n">result_dict</span><span class="p">,</span> <span class="n">status_msg_dict</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="src.sqooler.schemes.Spooler.check_dimension" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">check_dimension</span><span class="p">(</span><span class="n">json_dict</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Make sure that the Hilbert space dimension is not too large.</p>
<p>It can be implemented in the class that inherits, but it is not necessary.
So this is only a placeholder.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>json_dict</code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the dictonary with the instructions</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>str</code></td>          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the error message</p>
            </div>
          </td>
        </tr>
        <tr>
<td><code>bool</code></td>          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>is the dimension ok ?</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/sqooler/schemes.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">check_dimension</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">json_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Make sure that the Hilbert space dimension is not too large.</span>

<span class="sd">    It can be implemented in the class that inherits, but it is not necessary.</span>
<span class="sd">    So this is only a placeholder.</span>

<span class="sd">    Args:</span>
<span class="sd">        json_dict: the dictonary with the instructions</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: the error message</span>
<span class="sd">        bool: is the dimension ok ?</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># pylint: disable=W0613</span>
    <span class="k">return</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="src.sqooler.schemes.Spooler.check_experiment" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">check_experiment</span><span class="p">(</span><span class="n">exper_dict</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Check the validity of the experiment.
This has to be implement in each subclass extra.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>exper_dict</code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The dictionary that contains the logic and should
be verified.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/sqooler/schemes.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">check_experiment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exper_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Check the validity of the experiment.</span>
<span class="sd">    This has to be implement in each subclass extra.</span>

<span class="sd">    Args:</span>
<span class="sd">        exper_dict: The dictionary that contains the logic and should</span>
<span class="sd">            be verified.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Subclasses should implement this!&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="src.sqooler.schemes.Spooler.check_instructions" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">check_instructions</span><span class="p">(</span><span class="n">ins_list</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Check all the instruction to make sure that they are valid.</p>

          <details class="quote">
            <summary>Source code in <code>src/sqooler/schemes.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">check_instructions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ins_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Check all the instruction to make sure that they are valid.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">err_code</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="n">exp_ok</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">for</span> <span class="n">ins</span> <span class="ow">in</span> <span class="n">ins_list</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">gate_dict</span> <span class="o">=</span> <span class="n">gate_dict_from_list</span><span class="p">(</span><span class="n">ins</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ins_schema_dict</span><span class="p">[</span><span class="n">ins</span><span class="p">[</span><span class="mi">0</span><span class="p">]](</span><span class="o">**</span><span class="n">gate_dict</span><span class="p">)</span>
            <span class="n">exp_ok</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">except</span> <span class="n">ValidationError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">err_code</span> <span class="o">=</span> <span class="s2">&quot;Error in instruction &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
            <span class="n">exp_ok</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">exp_ok</span><span class="p">:</span>
            <span class="k">break</span>
    <span class="k">return</span> <span class="n">err_code</span><span class="p">,</span> <span class="n">exp_ok</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="src.sqooler.schemes.Spooler.check_json_dict" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">check_json_dict</span><span class="p">(</span><span class="n">json_dict</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Check if the json file has the appropiate syntax.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>json_dict</code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the dictonary that we will test.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>bool</code></td>          <td>
                <code>tuple[str, bool]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>is the expression having the appropiate syntax ?</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/sqooler/schemes.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">check_json_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">json_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Check if the json file has the appropiate syntax.</span>

<span class="sd">    Args:</span>
<span class="sd">        json_dict (dict): the dictonary that we will test.</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: is the expression having the appropiate syntax ?</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">expr</span> <span class="ow">in</span> <span class="n">json_dict</span><span class="p">:</span>
        <span class="n">err_code</span> <span class="o">=</span> <span class="s2">&quot;Wrong experiment name or too many experiments&quot;</span>
        <span class="c1"># Fix this pylint issue whenever you have time, but be careful !</span>
        <span class="c1"># pylint: disable=W0702</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">exp_ok</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">expr</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;experiment_&quot;</span><span class="p">)</span>
                <span class="ow">and</span> <span class="n">expr</span><span class="p">[</span><span class="mi">11</span><span class="p">:]</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()</span>
                <span class="ow">and</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">expr</span><span class="p">[</span><span class="mi">11</span><span class="p">:])</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_max_experiments</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">exp_ok</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">break</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">exp_ok</span><span class="p">:</span>
            <span class="k">break</span>
        <span class="c1"># test the structure of the experiment</span>
        <span class="n">err_code</span><span class="p">,</span> <span class="n">exp_ok</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_experiment</span><span class="p">(</span><span class="n">json_dict</span><span class="p">[</span><span class="n">expr</span><span class="p">])</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">exp_ok</span><span class="p">:</span>
            <span class="k">break</span>
        <span class="c1"># time to check the structure of the instructions</span>
        <span class="n">ins_list</span> <span class="o">=</span> <span class="n">json_dict</span><span class="p">[</span><span class="n">expr</span><span class="p">][</span><span class="s2">&quot;instructions&quot;</span><span class="p">]</span>
        <span class="n">err_code</span><span class="p">,</span> <span class="n">exp_ok</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_instructions</span><span class="p">(</span><span class="n">ins_list</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">exp_ok</span><span class="p">:</span>
            <span class="k">break</span>
    <span class="k">return</span> <span class="n">err_code</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;..&quot;</span><span class="p">),</span> <span class="n">exp_ok</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="src.sqooler.schemes.Spooler.get_configuration" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_configuration</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Sends back the configuration dictionary of the spooler.</p>

          <details class="quote">
            <summary>Source code in <code>src/sqooler/schemes.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_configuration</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Sends back the configuration dictionary of the spooler.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">gate_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">ins_obj</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ins_schema_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="s2">&quot;is_gate&quot;</span> <span class="ow">in</span> <span class="n">ins_obj</span><span class="o">.</span><span class="n">model_fields</span><span class="p">:</span>
            <span class="n">gate_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ins_obj</span><span class="o">.</span><span class="n">config_dict</span><span class="p">())</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">description</span><span class="p">,</span>
        <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">version</span><span class="p">,</span>
        <span class="s2">&quot;cold_atom_type&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">cold_atom_type</span><span class="p">,</span>
        <span class="s2">&quot;gates&quot;</span><span class="p">:</span> <span class="n">gate_list</span><span class="p">,</span>
        <span class="s2">&quot;max_experiments&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_max_experiments</span><span class="p">,</span>
        <span class="s2">&quot;max_shots&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_max_shots</span><span class="p">,</span>
        <span class="s2">&quot;simulator&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s2">&quot;supported_instructions&quot;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ins_schema_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span>
        <span class="s2">&quot;num_wires&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_wires</span><span class="p">,</span>
        <span class="s2">&quot;wire_order&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">wire_order</span><span class="p">,</span>
        <span class="s2">&quot;num_species&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_species</span><span class="p">,</span>
    <span class="p">}</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>



<div class="doc doc-object doc-function">




<h2 id="src.sqooler.schemes.create_memory_data" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">create_memory_data</span><span class="p">(</span><span class="n">shots_array</span><span class="p">,</span> <span class="n">exp_name</span><span class="p">,</span> <span class="n">n_shots</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>The function to create memory key in results dictionary
with proprer formatting.</p>

          <details class="quote">
            <summary>Source code in <code>src/sqooler/schemes.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">create_memory_data</span><span class="p">(</span>
    <span class="n">shots_array</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">exp_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">n_shots</span><span class="p">:</span> <span class="nb">int</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ExperimentDict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The function to create memory key in results dictionary</span>
<span class="sd">    with proprer formatting.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">exp_sub_dict</span><span class="p">:</span> <span class="n">ExperimentDict</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;header&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;experiment_0&quot;</span><span class="p">,</span> <span class="s2">&quot;extra metadata&quot;</span><span class="p">:</span> <span class="s2">&quot;text&quot;</span><span class="p">},</span>
        <span class="s2">&quot;shots&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
        <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;memory&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">},</span>
    <span class="p">}</span>

    <span class="n">exp_sub_dict</span><span class="p">[</span><span class="s2">&quot;header&quot;</span><span class="p">][</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">exp_name</span>
    <span class="n">exp_sub_dict</span><span class="p">[</span><span class="s2">&quot;shots&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">n_shots</span>
    <span class="n">memory_list</span> <span class="o">=</span> <span class="p">[</span>
        <span class="nb">str</span><span class="p">(</span><span class="n">shot</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;[&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;]&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">shot</span> <span class="ow">in</span> <span class="n">shots_array</span>
    <span class="p">]</span>
    <span class="n">exp_sub_dict</span><span class="p">[</span><span class="s2">&quot;data&quot;</span><span class="p">][</span><span class="s2">&quot;memory&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">memory_list</span>
    <span class="k">return</span> <span class="n">exp_sub_dict</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="src.sqooler.schemes.gate_dict_from_list" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">gate_dict_from_list</span><span class="p">(</span><span class="n">inst_list</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Transforms a list into an appropiate dictionnary for instructions.</p>

          <details class="quote">
            <summary>Source code in <code>src/sqooler/schemes.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">gate_dict_from_list</span><span class="p">(</span><span class="n">inst_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Transforms a list into an appropiate dictionnary for instructions.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">inst_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;wires&quot;</span><span class="p">:</span> <span class="n">inst_list</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;params&quot;</span><span class="p">:</span> <span class="n">inst_list</span><span class="p">[</span><span class="mi">2</span><span class="p">]}</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>







  
  






  <h2 id="__comments">Comments</h2>
  <script src="https://giscus.app/client.js"
        data-repo="alqor-ug/sqooler"
        data-repo-id="R_kgDOIsFD9A"
        data-category="Announcements"
        data-category-id="DIC_kwDOIsFD9M4CTajH"
        data-mapping="pathname"
        data-strict="0"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="top"
        data-theme="light"
        data-lang="en"
        data-loading="lazy"
        crossorigin="anonymous"
        async>
</script>

  <!-- Synchronize Giscus theme with palette -->
  <script>
    var giscus = document.querySelector("script[src*=giscus]")

    /* Set palette on initial load */
    var palette = __md_get("__palette")
    if (palette && typeof palette.color === "object") {
      var theme = palette.color.scheme === "slate" ? "dark" : "light"
      giscus.setAttribute("data-theme", theme) 


    }

    /* Register event handlers after documented loaded */
    document.addEventListener("DOMContentLoaded", function() {
      var ref = document.querySelector("[data-md-component=palette]")
      ref.addEventListener("change", function() {
        var palette = __md_get("__palette")
        if (palette && typeof palette.color === "object") {
          var theme = palette.color.scheme === "slate" ? "dark" : "light"

          /* Instruct Giscus to change theme */
          var frame = document.querySelector(".giscus-frame")
          frame.contentWindow.postMessage(
            { giscus: { setConfig: { theme } } },
            "https://giscus.app"
          )
        }
      })
    })
  </script>

                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href=".." class="md-footer__link md-footer__link--prev" aria-label="Previous: Introduction">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Introduction
              </div>
            </div>
          </a>
        
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.instant", "navigation.tracking", "navigation.expand", "navigation.footer", "toc.follow"], "search": "../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../assets/javascripts/bundle.d7c377c4.min.js"></script>
      
    
  </body>
</html>